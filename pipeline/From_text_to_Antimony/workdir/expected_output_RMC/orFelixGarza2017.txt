
model *FelixGarza2017___Blue_Light_Treatment_of_Psoriasis__simplified()

  // Compartments and Species:
  compartment compartmentOne, Psoriatic;
  species xFinal_1 in compartmentOne, xFinal_2 in compartmentOne, xFinal_3 in compartmentOne;
  species xFinal_4 in compartmentOne, xFinal_5 in compartmentOne, xFinal_6 in compartmentOne;
  species xFinal_7 in Psoriatic, xFinal_8 in Psoriatic, xFinal_9 in Psoriatic;
  species xFinal_10 in Psoriatic, xFinal_11 in Psoriatic, xFinal_12 in Psoriatic;

  // Assignment Rules:
  Ka := 3^(1/2)*Psch/10;

  // Reactions:
  R_1: xFinal_10 => xFinal_12; Psoriatic*(k4*rhoTr*xFinal_10/compartmentOne);
  R_2: xFinal_12 => ; Psoriatic*((alpha*rhoDe*xFinal_12 + apopFBL*xFinal_12)/compartmentOne);
  R_3: xFinal_9 => xFinal_10; Psoriatic*(k3*rhoTr*xFinal_9/compartmentOne);
  R_4: xFinal_10 => ; Psoriatic*((AId*k4*xFinal_10*(rhoTr/(1 - AId)) + apopFBL*xFinal_10)/compartmentOne);
  R_5: xFinal_8 => 2 xFinal_9; Psoriatic*(k2s*rhoTA*xFinal_8/compartmentOne);
  R_6: xFinal_8 => xFinal_8 + xFinal_9; Psoriatic*(k2a*rhoTA*xFinal_8/compartmentOne);
  R_7: xFinal_9 => ; Psoriatic*((AId*k3*xFinal_9*(rhoTr/(1 - AId)) + apopFBL*xFinal_9)/compartmentOne);
  R_8: xFinal_9 => xFinal_8; Psoriatic*(km2*xFinal_9/compartmentOne);
  R_9: xFinal_7 => 2 xFinal_8; Psoriatic*(k1sh*rhoSC*xFinal_7/compartmentOne);
  R_10: xFinal_7 => xFinal_7 + xFinal_8; Psoriatic*(k1ah*rhoSC*xFinal_7/compartmentOne);
  R_11: xFinal_8 => 2 xFinal_8; Psoriatic*(aProl*aProl*gamma2*rhoTA*exp(bProl*doseBL)*exp(bProl*doseBL)*xFinal_8/compartmentOne);
  R_12: xFinal_8 => ; Psoriatic*((AId*k2s*xFinal_8*(rhoTA/(1 - AId)) + apopFBL*xFinal_8)/compartmentOne);
  R_13: xFinal_8 => xFinal_7; Psoriatic*(km1*xFinal_8/compartmentOne);
  R_14: xFinal_7 => 2 xFinal_7; Psoriatic*(aProl*gamma1h*rhoSC*exp(bProl*doseBL)*xFinal_7/compartmentOne);
  R_15: xFinal_6 + xFinal_7 => xFinal_6; aProl*gamma1h*rhoSC*exp(bProl*doseBL)*xFinal_7*(xFinal_6/(lambda*Pscmax))/compartmentOne;
  R_16: xFinal_7 => ; Psoriatic*((aProl*gamma1h*rhoSC*exp(bProl*doseBL)*xFinal_7*(xFinal_7/(lambda*Pscmax)) + AId*k1sh*xFinal_7*(rhoSC/(1 - AId)) + apopFBL*xFinal_7 + Kp*(1/(Ka^2 + xFinal_7^2))*xFinal_7^2)/compartmentOne);
  R_17: xFinal_5 => xFinal_6; compartmentOne*(k5*xFinal_5/compartmentOne);
  R_18: xFinal_6 => ; compartmentOne*((alpha*xFinal_6 + apopFBL*xFinal_6)/compartmentOne);
  R_19: xFinal_4 => xFinal_5; compartmentOne*(k4*xFinal_4/compartmentOne);
  R_20: xFinal_5 => ; compartmentOne*((k5*xFinal_5*(AIh/(1 - AIh)) + apopFBL*xFinal_5)/compartmentOne);
  R_21: xFinal_3 => xFinal_4; compartmentOne*(k3*xFinal_3/compartmentOne);
  R_22: xFinal_4 => ; compartmentOne*((k4*xFinal_4*(AIh/(1 - AIh)) + apopFBL*xFinal_4)/compartmentOne);
  R_23: xFinal_2 => 2 xFinal_3; compartmentOne*(k2s*xFinal_2/compartmentOne);
  R_24: xFinal_2 => xFinal_2 + xFinal_3; compartmentOne*(k2a*xFinal_2/compartmentOne);
  R_25: xFinal_3 => ; compartmentOne*((k3*xFinal_3*(AIh/(1 - AIh)) + apopFBL*xFinal_3)/compartmentOne);
  R_26: xFinal_3 => xFinal_2; compartmentOne*(km2*xFinal_3/compartmentOne);
  R_27: xFinal_1 + xFinal_2 + xFinal_8 => xFinal_1 + 3 xFinal_2 + xFinal_8; omega*xFinal_1*(k1sh/(1 + (omega - 1)*((xFinal_2 + xFinal_8)/Ptah)^n))/compartmentOne;
  R_28: xFinal_1 + xFinal_2 + xFinal_8 => xFinal_1 + 2 xFinal_2 + xFinal_8; omega*xFinal_1*(k1ah/(1 + (omega - 1)*((xFinal_2 + xFinal_8)/Ptah)^n))/compartmentOne;
  R_29: xFinal_2 => 2 xFinal_2; compartmentOne*(aProl*gamma2*exp(bProl*doseBL)*xFinal_2/compartmentOne);
  R_30: xFinal_2 => ; compartmentOne*((k2s*xFinal_2*(AIh/(1 - AIh)) + apopFBL*xFinal_2)/compartmentOne);
  R_31: xFinal_2 => xFinal_1; compartmentOne*(km1*xFinal_2/compartmentOne);
  R_32: xFinal_1 + xFinal_2 + xFinal_8 => 2 xFinal_1 + xFinal_2 + xFinal_8; aProl*gamma1h*exp(bProl*doseBL)*xFinal_1*(omega/(1 + (omega - 1)*((xFinal_2 + xFinal_8)/Ptah)^n))/compartmentOne;
  R_33: xFinal_1 + xFinal_2 + xFinal_8 => xFinal_2 + xFinal_8; (gamma1h*(aProl*exp(bProl*doseBL)*xFinal_1*omega*xFinal_1/(1 + (omega - 1)*((xFinal_2 + xFinal_8)/Ptah)^n)/Pscmax) + k1sh*xFinal_1*(omega/(1 + (omega - 1)*((xFinal_2 + xFinal_8)/Ptah)^n)))/compartmentOne;
  R_34: xFinal_1 + xFinal_2 + xFinal_7 + xFinal_8 => xFinal_2 + xFinal_7 + xFinal_8; gamma1h*(aProl*exp(bProl*doseBL)*xFinal_1*omega*xFinal_7/(1 + (omega - 1)*((xFinal_2 + xFinal_8)/Ptah)^n)/lambda/Pscmax)/compartmentOne;
  R_35: xFinal_1 => ; compartmentOne*((k1sh*xFinal_1*(AIh/(1 - AIh)) + apopFBL*xFinal_1)/compartmentOne);

  // Events:
  Treatment_Break_after_28_days: at ((time > 28) && (time < 84)) && ((time - floor(time/(7/3))*(7/3)) > Treatment_Duration): doseBL = 0*90*skinType;
  Treatment_Start_after_28_days: at ((time > 28) && (time < 84)) && ((time - floor(time/(7/3))*(7/3)) < Treatment_Duration): doseBL = 90*skinType;
  Treatment_Stopped_on_Day_84: at time > 84: doseBL = 0;

  // Species initializations:
  xFinal_1 = 362;
  xFinal_2 = 77;
  xFinal_3 = 61;
  xFinal_4 = 238;
  xFinal_5 = 119;
  xFinal_6 = 185;
  xFinal_7 = 6459;
  xFinal_8 = 32098;
  xFinal_9 = 20536;
  xFinal_10 = 79788;
  xFinal_11 = 0;
  xFinal_12 = 77633;

  // Compartment initializations:
  compartmentOne = 1;
  Psoriatic = 1;

  // Variable initializations:
  Treatment_Duration = 1;
  doseBL = 90*skinType;
  skinType = 0.579;
  AId = 0.00035;
  AIh = 0.0012;
  alpha = 0.0714;
  alphaps = rhoDe*alpha;
  rhoDe = 4;
  apopFBL = 0;
  aProl = 1;
  beta1h = AIh*k1sh/(1 - AIh);
  k1sh = 0.00164;
  beta2 = AIh*k2s/(1 - AIh);
  k2s = 0.0173;
  beta3 = AIh*k3/(1 - AIh);
  k3 = 0.216;
  beta4 = AIh*k4/(1 - AIh);
  k4 = 0.0556;
  beta5 = AIh*k5/(1 - AIh);
  k5 = 0.111;
  betaps1 = AId*k1sh*rhoSC/(1 - AId);
  rhoSC = 4;
  betaps2 = AId*kps2s/(1 - AId);
  kps2s = rhoTA*k2s;
  betaps3 = AId*kps3/(1 - AId);
  kps3 = rhoTr*k3;
  betaps4 = AId*kps4/(1 - AId);
  kps4 = rhoTr*k4;
  bProl = -0.003404;
  gamma1h = 0.0033;
  gamma1ps = rhoSC*gamma1h;
  gamma2 = 0.014;
  gamma2ps = rhoTA*gamma2*thetaBLprol;
  rhoTA = 4;
  thetaBLprol = aProl*exp(bProl*doseBL);
  k1ah = 0.0131;
  k2a = 0.138;
  Psch = Pscmax*(1 - (1/gamma1h)*(k1sh + beta1h - km1*(k1ah + k1sh*2)/(km1 + k2s + beta2 - gamma2 - km2*(k2a + 2*k2s)/(km2 + k3 + beta3))));
  km1 = 1e-06;
  km2 = 1e-06;
  kmps1 = km1;
  kmps2 = km2;
  Kp = 6;
  kps1a = rhoSC*k1ah;
  kps1s = rhoSC*k1sh;
  kps2a = rhoTA*k2a;
  rhoTr = 5;
  lambda = 3.5;
  LPSI0 = 5.34;
  n = 3;
  omega = 100;
  Pscmax = 4500;
  Ptah = ((k1ah + 2*k1sh)/(km1 + k2s + beta2 - gamma2 - km2*(k2a + 2*k2s)/(km2 + k3 + beta3)))*Psch;
  therI = 84;

  // Other declarations:
  var doseBL, Ka;
  const compartmentOne, Psoriatic, Treatment_Duration, skinType, AId, AIh;
  const alpha, alphaps, rhoDe, apopFBL, aProl, beta1h, k1sh, beta2, k2s, beta3;
  const k3, beta4, k4, beta5, k5, betaps1, rhoSC, betaps2, kps2s, betaps3;
  const kps3, betaps4, kps4, bProl, gamma1h, gamma1ps, gamma2, gamma2ps, rhoTA;
  const thetaBLprol, k1ah, k2a, Psch, km1, km2, kmps1, kmps2, Kp, kps1a, kps1s;
  const kps2a, rhoTr, lambda, LPSI0, n, omega, Pscmax, Ptah, therI;

  // Unit definitions:
  unit time_unit = 86400 second;
  unit substance = 1e-3 mole;

  // Display Names:
  time_unit is "time";
  compartmentOne is "Healthy";
  xFinal_1 is "Stem Cells";
  xFinal_2 is "Transit Amplifying Cells";
  xFinal_3 is "Growth Arrested Cells";
  xFinal_4 is "Spinous cells";
  xFinal_5 is "Granular Cells";
  xFinal_6 is "Corneocytes";
  xFinal_7 is "Stem Cells";
  xFinal_8 is "Transit Amplifying Cells";
  xFinal_9 is "Growth Arrested Cells";
  xFinal_10 is "Spinous cells";
  xFinal_11 is "Granular Cells";
  xFinal_12 is "Corneocytes";
  Treatment_Break_after_28_days is "Treatment Break after 28 days";
  Treatment_Start_after_28_days is "Treatment Start after 28 days";
  Treatment_Stopped_on_Day_84 is "Treatment Stopped on Day 84";
  beta1h is "beta1";
  R_1 is "R_001";
  R_2 is "R_002";
  R_3 is "R_003";
  R_4 is "R_004";
  R_5 is "R_005";
  R_6 is "R_006";
  R_7 is "R_007";
  R_8 is "R_008";
  R_9 is "R_009";
  R_10 is "R_010";
  R_11 is "R_011";
  R_12 is "R_012";
  R_13 is "R_013";
  R_14 is "R_014";
  R_15 is "R_015";
  R_16 is "R_016";
  R_17 is "R_017";
  R_18 is "R_018";
  R_19 is "R_019";
  R_20 is "R_020";
  R_21 is "R_021";
  R_22 is "R_022";
  R_23 is "R_023";
  R_24 is "R_024";
  R_25 is "R_025";
  R_26 is "R_026";
  R_27 is "R_027";
  R_28 is "R_028";
  R_29 is "R_029";
  R_30 is "R_030";
  R_31 is "R_031";
  R_32 is "R_032";
  R_33 is "R_033";
  R_34 is "R_034";
  R_35 is "R_035";

end

