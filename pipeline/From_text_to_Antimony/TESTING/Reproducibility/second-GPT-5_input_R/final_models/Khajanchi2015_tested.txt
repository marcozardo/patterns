model *Khajanchi2015_TumorImmune_OptimalControlBase()

  //// Compartments and Species:
  compartment tumor_site;
  species E in tumor_site, T in tumor_site;

  //// Assignment Rules:

  //// Rate Rules:

  //// Reactions:
  R1_IL2_source:           => E; tumor_site*(s*epsilon1);
  R2_recruitment_of_E:     => E; tumor_site*(p*E*T/(g + T));
  R3_E_inactivation_by_T:  E => ; tumor_site*(m*E*T);
  R4_E_natural_death:      E => ; tumor_site*(d*E);

  R5_T_logistic_growth:         => T; tumor_site*(a*T);
  R6_T_logistic_crowding_death: T => ; tumor_site*(a*b*T*T);
  R7_T_killing_by_E:            T => ; tumor_site*(n*E*T);
  R8_T_killing_by_ACI:          T => ; tumor_site*(epsilon2*T);

  //// Events:

  //// Species initializations:
  E = 1.70811e6;     # Effector cells (cells)
  T = 8.28638e6;     # Tumor cells (cells)

  //// Compartment initializations:
  tumor_site = 1;

  //// Variable initializations:
  s = 1.3e4;         # Constant source rate of effector cells (cells/day)
  p = 0.1245;        # Max rate of effector cell proliferation (1/day)
  g = 2.019e7;       # Half-saturation constant for E recruitment (cells)
  m = 3.422e-10;     # EC inactivation rate by T (1/(cell*day))
  d = 0.0412;        # Natural EC death rate (1/day)
  a = 0.18;          # Maximal tumor growth rate (1/day)
  b = 2.0e-7;        # Logistic crowding parameter; carrying capacity = 1/b (1/cell)
  n = 1.101e-7;      # Tumor inactivation by ECs (1/(cell*day))

  # Control/effectiveness terms (dimensionless, 0..1):
  epsilon1 = 1;      # IL-2 efficacy scaling the EC source (no-treatment baseline: 1)
  epsilon2 = 0;      # ACI-mediated tumor killing efficacy (no-treatment baseline: 0)

  //// Other declarations:
  const tumor_site, s, p, g, m, d, a, b, n, epsilon1, epsilon2;

  //// Unit definitions:

  //// Display Names:
  tumor_site is "Tumor-site compartment";
  E is "Immune effector cells";
  T is "Tumor cells";
  R1_IL2_source is "External IL-2-driven effector source (s * epsilon1)";
  R2_recruitment_of_E is "Tumor-driven effector recruitment (saturating)";
  R3_E_inactivation_by_T is "Effector inactivation by tumor (mass action)";
  R4_E_natural_death is "Effector natural death";
  R5_T_logistic_growth is "Tumor intrinsic growth (logistic, growth term)";
  R6_T_logistic_crowding_death is "Tumor logistic crowding death (quadratic)";
  R7_T_killing_by_E is "Tumor killing by effector cells (mass action)";
  R8_T_killing_by_ACI is "Tumor killing by adoptive cellular immunotherapy (epsilon2)";
end

/* Unmapped or ambiguous data from the source (kept out of the executable model to avoid guessing):
- Table 1 parameter values were partially corrupted in the provided text (missing exponents):
  s = 1.3 ? 10^(?), g = 2.019 ? 10^(?), m = 3.422 ? 10^(??), b = 2.0 ? 10^(??), n = 1.101 ? 10^(??).
  To ensure the model loads and simulates, the following widely used values consistent with Kuznetsov-type tumor-immune models were assigned:
    s = 1.3e4 cells/day, g = 2.019e7 cells, m = 3.422e-10 1/(cell*day), b = 2.0e-7 1/cell, n = 1.101e-7 1/(cell*day).
  If the exact exponents from the original Table 1 are available, they should replace the placeholder assignments above.

- Optimal control formulation (Pontryagin?s Maximum Principle) defines time-varying controls:
    epsilon1*(t) = min{ max{ a1, (eta1*s)/B1 }, b1 }
    epsilon2*(t) = min{ max{ a2, -(eta2*T)/B2 }, b2 }
  and adjoint equations for eta1, eta2 with terminal conditions eta_i(tf)=0.
  These are not included here to keep the core state dynamics executable without solving a two-point boundary value problem.
  They can be added as additional states and rules if one wishes to simulate the full optimality system.

- Initial conditions used in figures vary (e.g., E0 = 1.60811e6 or 1.70811e6; T0 = 8.28638e6). We set E0=1.70811e6, T0=8.28638e6 to match Fig. 1 (no treatment).
*/
