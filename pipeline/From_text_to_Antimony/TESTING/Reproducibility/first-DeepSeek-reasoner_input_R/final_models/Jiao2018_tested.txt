model *Jiao2018_AML_feedback()

  //// Compartments and Species:
  compartment bone_marrow;
  species S in bone_marrow, A in bone_marrow, D in bone_marrow, L in bone_marrow, T in bone_marrow;

  //// Assignment Rules:
  Z1 := S;
  Z2 := A + L;
  p1 := p10 / (1 + g1 * D);
  p2 := p20 / (1 + g2 * D);
  v1 := v10 / (1 + h1 * D);
  v2 := v20 / (1 + h2 * D);

  //// Reactions:
  R1: S => 2 S; bone_marrow * (p1 * v1 * S * (K1 - Z1));
  R2: S => 2 A; bone_marrow * ((1 - p1) * v1 * S);
  R3: A => 2 A; bone_marrow * (p2 * v2 * A * (K2 - Z2));
  R4: A => 2 D; bone_marrow * ((1 - p2) * v2 * A);
  R5: D => ; bone_marrow * (d1 * D);
  R6: L => 2 L; bone_marrow * (p30 * v30 * L * (K2 - Z2));
  R7: L => 2 T; bone_marrow * ((1 - p30) * v30 * L);
  R8: T => ; bone_marrow * (d2 * T);

  //// Species initializations:
  S = 10;
  A = 0;
  D = 0;
  L = 10;
  T = 0;

  //// Compartment initializations:
  bone_marrow = 1;

  //// Variable initializations:
  p10 = 0.65;
  p20 = 0.68;
  p30 = 0.80;
  v10 = 0.50;
  v20 = 0.72;
  v30 = 0.70;
  d1 = 0.275;
  d2 = 0.30;
  g1 = 0.03;
  g2 = 0.025;
  h1 = 0.2;
  h2 = 0.11;
  K1 = 1;
  K2 = 1;

  //// Other declarations:
  var p1, p2, v1, v2, Z1, Z2;
  const bone_marrow, p10, p20, p30, v10, v20, v30, d1, d2, g1, g2, h1, h2, K1, K2;

  //// Display Names:
  bone_marrow is "Bone marrow compartment";
  S is "Haematopoietic stem cells (S)";
  A is "Progenitor cells (A)";
  D is "Terminally differentiated cells of S (D)";
  L is "Leukaemia stem cells (L)";
  T is "Terminally differentiated cells of L (T)";
  p10 is "Maximal differentiation probability of S";
  p20 is "Maximal differentiation probability of A";
  p30 is "Maximal differentiation probability of L";
  v10 is "Division rate of haematopoietic stem cells";
  v20 is "Division rate of progenitor cells";
  v30 is "Division rate of leukemogenesis stem cells";
  d1 is "Death rate of D cells";
  d2 is "Death rate of T cells";
  g1 is "Feedback coefficient of S from D (probability)";
  g2 is "Feedback coefficient of A from D (probability)";
  h1 is "Feedback coefficient of S from D (division rate)";
  h2 is "Feedback coefficient of A from D (division rate)";
  K1 is "Carrying capacity of compartment with S";
  K2 is "Carrying capacity of compartment with A and L";
  Z1 is "Total niche size of S";
  Z2 is "Total niche size of A and L";
  p1 is "Self-renewal probability of S (function of D)";
  p2 is "Self-renewal probability of A (function of D)";
  v1 is "Division rate of S (function of D)";
  v2 is "Division rate of A (function of D)";
  R1 is "Self-renewal of haematopoietic stem cells";
  R2 is "Differentiation of S to 2A";
  R3 is "Self-renewal of progenitor cells";
  R4 is "Differentiation of A to 2D";
  R5 is "Death of D cells";
  R6 is "Self-renewal of leukaemia stem cells";
  R7 is "Differentiation of L to 2T";
  R8 is "Death of T cells";

end
