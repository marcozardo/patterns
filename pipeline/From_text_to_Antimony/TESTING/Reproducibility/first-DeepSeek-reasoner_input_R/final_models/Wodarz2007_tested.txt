model *Wodarz2007_HIV_CD4_dynamics()

  //// Compartments and Species:
  compartment body;
  species T in body, I in body, x in body, y in body, v in body;
  species m0 in body, m1 in body, m2 in body, m3 in body, m4 in body, m5 in body, m6 in body, m7 in body, m8 in body, m9 in body;
  species w in body, z in body;

  //// Reactions:
  prod_T: => T; lambda_;                                                 
  death_T: T => ; delta*T;                                              
  infect_T: T => I; gamma_*T*v;                                          
  death_I: I => ; alpha*I;                                              
  kill_I: I => ; p*I*(w + z);                                           

  prolif_x: => x; r*x*v*(1 - (x + y)/k);                                
  death_x: x => ; d*x;                                                  
  infect_x: x => y; beta_*x*v;                                           
  prolif_y: => y; r*y*v*(1 - (x + y)/k);                                
  death_y: y => ; a*y;                                                  
  kill_y: y => ; p*y*(w + z);                                           

  prod_v_y: => v; eta*y;                                                
  prod_v_I: => v; eta*I;                                                
  decay_v: v => ; u*v;                                                  

  div0: m0 => 2 m1; rho*m0;
  div1: m1 => 2 m2; rho*m1;
  div2: m2 => 2 m3; rho*m2;
  div3: m3 => 2 m4; rho*m3;
  div4: m4 => 2 m5; rho*m4;
  div5: m5 => 2 m6; rho*m5;
  div6: m6 => 2 m7; rho*m6;
  div7: m7 => 2 m8; rho*m7;
  div8: m8 => 2 m9; rho*m8;
  div9: m9 => 2 w; rho*m9;

  death_w: w => ; xi*w;                                                 
  diff_w: w => z; phi*w;                                                

  prolif_z: z => 2 z; c*x*(y + I)*z/(epsilon*x + 1);                    
  death_z: z => ; b*z;                                                  

  //// Species initializations:
  T = 5;         
  I = 0.0001;
  x = 0.1;       
  y = 0;
  v = 0.0001;    
  m0 = 0.1;
  m1 = 0;
  m2 = 0;
  m3 = 0;
  m4 = 0;
  m5 = 0;
  m6 = 0;
  m7 = 0;
  m8 = 0;
  m9 = 0;
  w = 0;
  z = 0;

  //// Compartment initializations:
  body = 1;

  //// Variable initializations:
  lambda_ = 1;
  r = 1;
  gamma_ = 0.01;
  delta = 0.2;
  beta_ = 0.01;
  alpha = 0.3;
  d = 0.001;
  a = 0.2;
  k = 10;
  eta = 1;
  u = 1;
  p = 45;
  c = 1;
  b = 0.1;
  epsilon = 1.5;
  phi = 0.01;
  rho = 1;
  xi = 0.1;      
  n = 10;        

  //// Other declarations:
  var beta_, gamma_;        
  const lambda_, r, delta, alpha, d, a, k, eta, u, p, c, b, epsilon, phi, rho, xi, n;

  //// Events:
  therapy_start: at time >= 300: beta_ = 0, gamma_ = 0;   

  //// Unit definitions:
  unit time_unit = 1 day;              
  unit substance = 1 cell;             
  unit volume = 1 liter;               

  //// Display Names:
  body is "Host";
  T is "Non-specific susceptible target cells";
  I is "Infected non-specific target cells";
  x is "Uninfected HIV-specific CD4 T cells";
  y is "Infected HIV-specific CD4 T cells";
  v is "Free HIV particles";
  m0 is "Activated naive CTL";
  m1 is "CTL after 1 division";
  m2 is "CTL after 2 divisions";
  m3 is "CTL after 3 divisions";
  m4 is "CTL after 4 divisions";
  m5 is "CTL after 5 divisions";
  m6 is "CTL after 6 divisions";
  m7 is "CTL after 7 divisions";
  m8 is "CTL after 8 divisions";
  m9 is "CTL after 9 divisions";
  w is "Effector CTL";
  z is "Memory CTL";
  lambda_ is "Production rate of non-specific target cells";
  r is "Proliferation rate of specific CD4 T cells";
  gamma_ is "Infection rate of non-specific target cells";
  delta is "Death rate of non-specific target cells";
  beta_ is "Infection rate of specific CD4 T cells";
  alpha is "Death rate of infected non-specific target cells";
  d is "Death rate of uninfected specific CD4 T cells";
  a is "Death rate of infected specific CD4 T cells";
  k is "Carrying capacity of specific CD4 T cells";
  eta is "Virus production rate per infected cell";
  u is "Clearance rate of free virus";
  p is "CTL killing rate";
  c is "Memory CTL proliferation coefficient";
  b is "Death rate of memory CTL";
  epsilon is "Saturation constant for help";
  phi is "Differentiation rate of effectors to memory";
  rho is "CTL division rate";
  xi is "Death rate of effector CTL";
  n is "Number of CTL divisions";
  prod_T is "Production of non-specific target cells";
  death_T is "Death of non-specific target cells";
  infect_T is "Infection of non-specific target cells";
  death_I is "Death of infected non-specific cells";
  kill_I is "CTL killing of infected non-specific cells";
  prolif_x is "Proliferation of uninfected specific CD4 T cells";
  death_x is "Death of uninfected specific CD4 T cells";
  infect_x is "Infection of specific CD4 T cells";
  prolif_y is "Proliferation of infected specific CD4 T cells";
  death_y is "Death of infected specific CD4 T cells";
  kill_y is "CTL killing of infected specific CD4 T cells";
  prod_v_y is "Virus production from infected specific CD4 T cells";
  prod_v_I is "Virus production from infected non-specific cells";
  decay_v is "Clearance of free virus";
  div0 is "CTL division step 0";
  div1 is "CTL division step 1";
  div2 is "CTL division step 2";
  div3 is "CTL division step 3";
  div4 is "CTL division step 4";
  div5 is "CTL division step 5";
  div6 is "CTL division step 6";
  div7 is "CTL division step 7";
  div8 is "CTL division step 8";
  div9 is "CTL division step 9";
  death_w is "Death of effector CTL";
  diff_w is "Differentiation of effectors to memory";
  prolif_z is "Proliferation of memory CTL";
  death_z is "Death of memory CTL";
  therapy_start is "Start of antiretroviral therapy";

end
