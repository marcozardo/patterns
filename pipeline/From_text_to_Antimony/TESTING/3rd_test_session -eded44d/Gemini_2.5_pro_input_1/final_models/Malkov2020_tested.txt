/*
 * MODEL 1: SEIRS with Continuous Waning Immunity and Time-Varying Mitigation
 *
 * This model captures the primary dynamics described in Section 2 of the paper,
 * representing a Susceptible-Exposed-Infectious-Resistant-Susceptible (SEIRS)
 * framework. It includes a continuous rate of immunity loss (omega) and a
 * time-varying transmission rate, beta(t), which is governed by a time-varying
 * reproduction number, R_tilde(t). The dynamics of R_tilde(t) are modeled using
 * differential equations to simulate changing mitigation policies. This implementation
 * uses the parameter values for the "U-shaped" mitigation scenario from Section 3.
 */
model *Malkov2020_SEIRS_ContinuousWaning()

  //// Compartments and Species:
  compartment population;
  species S in population, E in population, I in population, R in population;

  //// Assignment Rules:
  beta := gamma * R_tilde;
  R_tilde := 0.5 * (R_tilde_1 + R_tilde_2);

  //// Rate Rules:
  R_tilde_1' = -eta1 * (R_tilde_1 - R1_star);
  R_tilde_2' = -eta2 * (R_tilde_2 - R2_star);

  //// Reactions:
  infection: S -> E; beta * S * I / N;
  progression: E -> I; sigma * E;
  recovery: I -> R; gamma * I;
  waning_immunity: R -> S; omega * R;

  //// Species initializations:
  I = 0.001;
  E = 43.75 * I;
  R = 0;
  S = 0.95525;

  //// Compartment initializations:
  population = 1;

  //// Variable initializations:
  N = 1;
  sigma = 1/5.2;      // Mean latent period of 5.2 days (infection rate)
  gamma = 1/18;       // Mean infectious period of 18 days (recovery rate)
  omega = 1/183;      // Immunity waning rate (one of several values explored)
  
  // Parameters for U-shaped R(t) scenario from Section 3
  R_tilde_1 = 10;     // Initial value for R_tilde_1
  R_tilde_2 = -4;     // Initial value for R_tilde_2
  R1_star = -10;      // Long-run value for R_tilde_1
  R2_star = 4;        // Long-run value for R_tilde_2
  eta1 = 1/35;        // Convergence rate for R_tilde_1
  eta2 = 1/100;       // Convergence rate for R_tilde_2

  //// Other declarations:
  var beta, R_tilde, R_tilde_1, R_tilde_2;
  const population, N, sigma, gamma, omega, eta1, eta2, R1_star, R2_star;

  //// Display Names:
  S is "Susceptible population";
  E is "Exposed population";
  I is "Infected population";
  R is "Resistant (recovered) population";
  R_tilde is "Time-varying reproduction number";
  beta is "Time-varying transmission rate";
  sigma is "Infection rate (exposed to infected)";
  gamma is "Recovery rate";
  omega is "Immunity waning rate";
end
