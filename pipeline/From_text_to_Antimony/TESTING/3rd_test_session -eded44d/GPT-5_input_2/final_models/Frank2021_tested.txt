model *Frank2021_MacrophagePolarization()

  //// Compartments and Species:
  compartment cell;
  species x1 in cell, x2 in cell;

  //// Assignment Rules:
  Hplus1 := x1^n1 / (x1^n1 + k1^n1);
  Hplus2 := x2^n2 / (x2^n2 + k2^n2);
  Hminus1 := p1^l1 / (p1^l1 + x1^l1);
  Hminus2 := p2^l2 / (p2^l2 + x2^l2);

  //// Rate Rules:
  x1' = (a1*Hplus1 + S1)*Hminus2 + b1 - q1*x1;
  x2' = a2*Hplus2 + S2*Hminus1 + b2 - q2*x2;

  //// Species initializations:
  x1 = 0;
  x2 = 0;

  //// Compartment initializations:
  cell = 1;

  //// Variable initializations:
  a1 = 5;
  a2 = 5;
  b1 = 0.05;
  b2 = 0.05;
  n1 = 6;
  n2 = 6;
  k1 = 1;
  k2 = 1;
  l1 = 1;
  l2 = 1;
  p1 = 0.5;
  p2 = 1;
  q1 = 5;
  q2 = 5;
  S1 = 3.75;
  S2 = 3.75;

  //// Other declarations:
  var Hplus1, Hplus2, Hminus1, Hminus2;
  const cell, a1, a2, b1, b2, n1, n2, k1, k2, l1, l2, p1, p2, q1, q2, S1, S2;

  //// Display Names:
  x1 is "Activated STAT1 level (proxy for M1)";
  x2 is "Activated STAT6 level (proxy for M2)";
  Hplus1 is "Self-stimulation Hill (STAT1)";
  Hplus2 is "Self-stimulation Hill (STAT6)";
  Hminus1 is "Mutual inhibition Hill (STAT1 inhibited by STAT1 term for S2 input)";
  Hminus2 is "Mutual inhibition Hill (STAT6 inhibits STAT1 pathways)";
  cell is "Macrophage (well-mixed)";

end

/* Alternative parameter sets from Table 2 (use by replacing values in Variable initializations):

Theta_1 (only S1,S2 changed from Theta_0):
  S1 = 4;
  S2 = 4;

Theta_2 (increased self-stimulation and deactivation; asymmetric n1):
  a1 = 15;
  a2 = 8;
  b1 = 0.05;
  b2 = 0.05;
  n1 = 22;
  n2 = 6;
  k1 = 1;
  k2 = 1;
  l1 = 1;
  l2 = 1;
  p1 = 0.5;
  p2 = 1;
  q1 = 5.8;
  q2 = 5.8;
  S1 = 5;
  S2 = 5;
*/
