model *Kok2020_IFNa_Signaling()

  //// Compartments and Species:
  compartment cytoplasm, nucleus;

  // Species in the cytoplasm
  species Rec in cytoplasm, aRecIFN in cytoplasm;
  species STAT1c in cytoplasm, STAT2c in cytoplasm, IRF9c in cytoplasm;
  species pSTAT1dimc in cytoplasm, pSTAT1pSTAT2c in cytoplasm, ISGF3c in cytoplasm;
  species SOCS1 in cytoplasm, SOCS3 in cytoplasm, USP18 in cytoplasm, IRF2 in cytoplasm;
  species STAT1_mRNA in cytoplasm, STAT2_mRNA in cytoplasm, IRF9_mRNA in cytoplasm;
  species SOCS1_mRNA in cytoplasm, SOCS3_mRNA in cytoplasm, USP18_mRNA in cytoplasm, IRF2_mRNA in cytoplasm;

  // Species in the nucleus
  species STAT1n in nucleus, STAT2n in nucleus, IRF9n in nucleus;
  species pSTAT1dimn in nucleus, pSTAT1pSTAT2n in nucleus, ISGF3n in nucleus;
  species OccGASbs in nucleus, OccGAS_ISREbs in nucleus;

  //// Reactions:
  
  // Basal synthesis and degradation of receptor
  R0: => Rec; k_synth_Rec;
  deg_Rec: Rec -> ; k_deg_Rec * Rec;

  // Receptor dynamics
  // R1: IFNalpha binding and receptor activation, inhibited by SOCS1, SOCS3, USP18
  R1: Rec => aRecIFN; k_Rec_act * Rec * IFN_param / (1 + SOCS1/KI_SOCS1 + SOCS3/KI_SOCS3 + USP18/KI_USP18);
  // R2: Receptor inactivation
  R2: aRecIFN => Rec; k_Rec_inact * aRecIFN;
  // R3: Activated receptor degradation, basal and enhanced by SOCS1 and SOCS1:USP18
  R3: aRecIFN => ; (k_aRec_deg_basal + k_aRec_deg_SOCS1*SOCS1 + k_aRec_deg_SOCS1_USP18*SOCS1*USP18) * aRecIFN;

  // STAT phosphorylation and complex formation in cytoplasm
  // R4: STAT1 phosphorylation and homodimerization, catalyzed by aRecIFN
  R4: 2 STAT1c => pSTAT1dimc; k_pSTAT1_form * STAT1c^2 * aRecIFN;
  // R5: STAT1/STAT2 phosphorylation and heterodimerization, catalyzed by aRecIFN
  R5: STAT1c + STAT2c => pSTAT1pSTAT2c; k_pSTAT12_form * STAT1c * STAT2c * aRecIFN;
  // R6: ISGF3 formation
  R6: pSTAT1pSTAT2c + IRF9c -> ISGF3c; k_ISGF3_form * pSTAT1pSTAT2c * IRF9c;
  // R7: ISGF3 dissociation
  R7: ISGF3c -> pSTAT1pSTAT2c + IRF9c; k_ISGF3_diss * ISGF3c;

  // Nucleo-cytoplasmic transport
  // T1: STAT monomers shuttling
  T1f: STAT1c -> STAT1n; k_imp_S1 * STAT1c;
  T1r: STAT1n -> STAT1c; k_exp_S1 * STAT1n;
  T2f: STAT2c -> STAT2n; k_imp_S2 * STAT2c;
  T2r: STAT2n -> STAT2c; k_exp_S2 * STAT2n;
  T3f: IRF9c -> IRF9n; k_imp_I9 * IRF9c;
  T3r: IRF9n -> IRF9c; k_exp_I9 * IRF9n;
  // T4: STAT complexes transport
  T4f: pSTAT1dimc -> pSTAT1dimn; k_imp_pS1d * pSTAT1dimc;
  T4r: pSTAT1dimn -> pSTAT1dimc; k_exp_pS1d * pSTAT1dimn;
  T5f: pSTAT1pSTAT2c -> pSTAT1pSTAT2n; k_imp_pS12 * pSTAT1pSTAT2c;
  T5r: pSTAT1pSTAT2n -> pSTAT1pSTAT2c; k_exp_pS12 * pSTAT1pSTAT2n;
  T6f: ISGF3c -> ISGF3n; k_imp_ISGF3 * ISGF3c;
  T6r: ISGF3n -> ISGF3c; k_exp_ISGF3 * ISGF3n;
  
  // Nuclear dynamics
  // D1: Nuclear complex dissociation and dephosphorylation (implicit)
  D1: pSTAT1dimn -> 2 STAT1n; k_diss_pS1d * pSTAT1dimn;
  D2: pSTAT1pSTAT2n -> STAT1n + STAT2n; k_diss_pS12 * pSTAT1pSTAT2n;
  D3: ISGF3n -> STAT1n + STAT2n + IRF9n; k_diss_ISGF3 * ISGF3n;

  // Promoter binding
  PB1: pSTAT1dimn -> OccGASbs; k_bind_gas * pSTAT1dimn - k_unbind_gas * OccGASbs;
  PB3: pSTAT1pSTAT2n -> OccGAS_ISREbs; k_bind_gas_isre1 * pSTAT1pSTAT2n - k_unbind_gas_isre1 * OccGAS_ISREbs;
  PB5: ISGF3n -> OccGAS_ISREbs; k_bind_gas_isre2 * ISGF3n - k_unbind_gas_isre2 * OccGAS_ISREbs;

  // Transcription
  // Basal transcription for all feedback genes
  TR_basal_S1: => STAT1_mRNA; k_sync_STAT1_basal;
  TR_basal_S2: => STAT2_mRNA; k_sync_STAT2_basal;
  TR_basal_I9: => IRF9_mRNA; k_sync_IRF9_basal;
  TR_basal_SCS1: => SOCS1_mRNA; k_sync_SOCS1_basal;
  TR_basal_SCS3: => SOCS3_mRNA; k_sync_SOCS3_basal;
  TR_basal_U18: => USP18_mRNA; k_sync_USP18_basal;
  TR_basal_IRF2: => IRF2_mRNA; k_sync_IRF2_basal;  
  // Induced transcription (with saturation)
  TR_ind_SOCS3: => SOCS3_mRNA; Vmax_SOCS3 * OccGASbs / (Km_SOCS3 + OccGASbs);
  TR_ind_STAT1: => STAT1_mRNA; Vmax_STAT1 * OccGAS_ISREbs / (Km_STAT1 + OccGAS_ISREbs);
  TR_ind_STAT2: => STAT2_mRNA; Vmax_STAT2 * OccGAS_ISREbs / (Km_STAT2 + OccGAS_ISREbs);
  TR_ind_IRF9:  => IRF9_mRNA;  Vmax_IRF9 * OccGAS_ISREbs / (Km_IRF9 + OccGAS_ISREbs);
  TR_ind_SOCS1: => SOCS1_mRNA; Vmax_SOCS1 * OccGAS_ISREbs / (Km_SOCS1 + OccGAS_ISREbs);
  TR_ind_USP18: => USP18_mRNA; Vmax_USP18 * OccGAS_ISREbs / (Km_USP18 + OccGAS_ISREbs);
  TR_ind_IRF2:  => IRF2_mRNA;  Vmax_IRF2 * OccGAS_ISREbs / (Km_IRF2 + OccGAS_ISREbs);
  
  // Translation
  TL1: STAT1_mRNA => STAT1_mRNA + STAT1c; k_tl_STAT1 * STAT1_mRNA;
  TL2: STAT2_mRNA => STAT2_mRNA + STAT2c; k_tl_STAT2 * STAT2_mRNA;
  TL3: IRF9_mRNA => IRF9_mRNA + IRF9c; k_tl_IRF9 * IRF9_mRNA;
  TL4: SOCS1_mRNA => SOCS1_mRNA + SOCS1; k_tl_SOCS1 * SOCS1_mRNA;
  TL5: SOCS3_mRNA => SOCS3_mRNA + SOCS3; k_tl_SOCS3 * SOCS3_mRNA;
  TL6: USP18_mRNA => USP18_mRNA + USP18; k_tl_USP18 * USP18_mRNA;
  TL7: IRF2_mRNA => IRF2_mRNA + IRF2; k_tl_IRF2 * IRF2_mRNA;

  // mRNA Degradation
  deg_mRNA_S1: STAT1_mRNA -> ; k_deg_STAT1_mRNA * STAT1_mRNA;
  deg_mRNA_S2: STAT2_mRNA -> ; k_deg_STAT2_mRNA * STAT2_mRNA;
  deg_mRNA_I9: IRF9_mRNA -> ; k_deg_IRF9_mRNA * IRF9_mRNA;
  deg_mRNA_SCS1: SOCS1_mRNA -> ; (k_deg_SOCS1_mRNA_basal + k_deg_SOCS1_mRNA_IRF2 * IRF2) * SOCS1_mRNA;
  deg_mRNA_SCS3: SOCS3_mRNA -> ; k_deg_SOCS3_mRNA * SOCS3_mRNA;
  deg_mRNA_U18: USP18_mRNA -> ; k_deg_USP18_mRNA * USP18_mRNA;
  deg_mRNA_IRF2: IRF2_mRNA -> ; k_deg_IRF2_mRNA * IRF2_mRNA;
  
  // Protein Degradation (turnover)
  deg_prot_S1c: STAT1c -> ; k_deg_prot * STAT1c;
  deg_prot_S2c: STAT2c -> ; k_deg_prot * STAT2c;
  deg_prot_I9c: IRF9c -> ; k_deg_prot * IRF9c;
  deg_prot_S1n: STAT1n -> ; k_deg_prot * STAT1n;
  deg_prot_S2n: STAT2n -> ; k_deg_prot * STAT2n;
  deg_prot_I9n: IRF9n -> ; k_deg_prot * IRF9n;
  deg_prot_SCS1: SOCS1 -> ; k_deg_SOCS1 * SOCS1;
  deg_prot_SCS3: SOCS3 -> ; k_deg_SOCS3 * SOCS3;
  deg_prot_U18: USP18 -> ; k_deg_USP18 * USP18;
  deg_prot_IRF2: IRF2 -> ; k_deg_IRF2 * IRF2;

  //// Events:
  // Simulates an experimental protocol: prestimulation with 2.8 pM IFNalpha, then stimulation with 1400 pM
  E_prestim: at(time > 0): IFN_param = 2.8;
  E_stim: at(time >= 24): IFN_param = 1400;

  //// Species initializations:
  Rec = 1000;      // Abundance in molecules/cell, placeholder
  aRecIFN = 0;
  STAT1c = 750000; // From Fig 3C, mean of 5e5 and 1e6
  STAT2c = 50000;  // From Fig 3C
  IRF9c = 1000;    // From Fig 3C, "very low levels"
  USP18 = 1000;    // From Fig 3C, "very low levels"
  
  // Initialize all other species to 0
  pSTAT1dimc = 0; pSTAT1pSTAT2c = 0; ISGF3c = 0;
  SOCS1 = 0; SOCS3 = 0; IRF2 = 0;
  STAT1_mRNA = 0; STAT2_mRNA = 0; IRF9_mRNA = 0;
  SOCS1_mRNA = 0; SOCS3_mRNA = 0; USP18_mRNA = 0; IRF2_mRNA = 0;
  STAT1n = 0; STAT2n = 0; IRF9n = 0;
  pSTAT1dimn = 0; pSTAT1pSTAT2n = 0; ISGF3n = 0;
  OccGASbs = 0; OccGAS_ISREbs = 0;

  //// Compartment initializations:
  cytoplasm = 1; // unit: volume, placeholder
  nucleus = 0.5;   // unit: volume, placeholder

  //// Variable initializations:
  IFN_param = 0; // External IFNalpha concentration in pM
  
  // Placeholder kinetic parameters (values are illustrative, not from paper)
  k_synth_Rec = 10; k_deg_Rec = 0.01;
  k_Rec_act = 0.01; KI_SOCS1 = 1000; KI_SOCS3 = 1000; KI_USP18 = 1000;
  k_Rec_inact = 0.1;
  k_aRec_deg_basal = 0.01; k_aRec_deg_SOCS1 = 0.001; k_aRec_deg_SOCS1_USP18 = 0.001;
  k_pSTAT1_form = 1e-12; k_pSTAT12_form = 1e-9;
  k_ISGF3_form = 0.01; k_ISGF3_diss = 0.1;
  k_imp_S1 = 0.1; k_exp_S1 = 0.05;
  k_imp_S2 = 0.1; k_exp_S2 = 0.05;
  k_imp_I9 = 0.1; k_exp_I9 = 0.05;
  k_imp_pS1d = 0.1; k_exp_pS1d = 0.01;
  k_imp_pS12 = 0.1; k_exp_pS12 = 0.01;
  k_imp_ISGF3 = 0.1; k_exp_ISGF3 = 0.01;
  k_diss_pS1d = 0.1; k_diss_pS12 = 0.1; k_diss_ISGF3 = 0.1;
  k_bind_gas = 0.01; k_unbind_gas = 0.1;
  k_bind_gas_isre1 = 0.01; k_unbind_gas_isre1 = 0.1;
  k_bind_gas_isre2 = 0.02; k_unbind_gas_isre2 = 0.1; // ISGF3 binds stronger
  
  k_sync_STAT1_basal = 0.1; k_sync_STAT2_basal = 0.1; k_sync_IRF9_basal = 0.1;
  k_sync_SOCS1_basal = 0.1; k_sync_SOCS3_basal = 0.1; k_sync_USP18_basal = 0.1; k_sync_IRF2_basal = 0.1;
  
  Vmax_SOCS3 = 10; Km_SOCS3 = 100; Vmax_STAT1 = 10; Km_STAT1 = 100;
  Vmax_STAT2 = 10; Km_STAT2 = 100; Vmax_IRF9 = 10; Km_IRF9 = 100;
  Vmax_SOCS1 = 10; Km_SOCS1 = 100; Vmax_USP18 = 10; Km_USP18 = 100; Vmax_IRF2 = 10; Km_IRF2 = 100;
  
  k_tl_STAT1=0.1; k_tl_STAT2=0.1; k_tl_IRF9=0.1; k_tl_SOCS1=0.1; k_tl_SOCS3=0.1; k_tl_USP18=0.1; k_tl_IRF2=0.1;
  
  k_deg_STAT1_mRNA = 0.1; k_deg_STAT2_mRNA = 0.1; k_deg_IRF9_mRNA = 0.1;
  k_deg_SOCS1_mRNA_basal = 0.1; k_deg_SOCS1_mRNA_IRF2 = 0.001;
  k_deg_SOCS3_mRNA = 0.2; k_deg_USP18_mRNA = 0.1; k_deg_IRF2_mRNA = 0.1;

  k_deg_prot = 0.01;
  k_deg_SOCS1 = 0.02; k_deg_SOCS3 = 0.05; k_deg_USP18 = 0.02; k_deg_IRF2 = 0.02;

  //// Other declarations:
  var IFN_param;
  const cytoplasm, nucleus;
  const k_synth_Rec, k_deg_Rec;
  const k_Rec_act, KI_SOCS1, KI_SOCS3, KI_USP18;
  const k_Rec_inact, k_aRec_deg_basal, k_aRec_deg_SOCS1, k_aRec_deg_SOCS1_USP18;
  const k_pSTAT1_form, k_pSTAT12_form, k_ISGF3_form, k_ISGF3_diss;
  const k_imp_S1, k_exp_S1, k_imp_S2, k_exp_S2, k_imp_I9, k_exp_I9;
  const k_imp_pS1d, k_exp_pS1d, k_imp_pS12, k_exp_pS12, k_imp_ISGF3, k_exp_ISGF3;
  const k_diss_pS1d, k_diss_pS12, k_diss_ISGF3;
  const k_bind_gas, k_unbind_gas, k_bind_gas_isre1, k_unbind_gas_isre1, k_bind_gas_isre2, k_unbind_gas_isre2;
  const k_sync_STAT1_basal, k_sync_STAT2_basal, k_sync_IRF9_basal;
  const k_sync_SOCS1_basal, k_sync_SOCS3_basal, k_sync_USP18_basal, k_sync_IRF2_basal;
  const Vmax_SOCS3, Km_SOCS3, Vmax_STAT1, Km_STAT1, Vmax_STAT2, Km_STAT2;
  const Vmax_IRF9, Km_IRF9, Vmax_SOCS1, Km_SOCS1, Vmax_USP18, Km_USP18, Vmax_IRF2, Km_IRF2;
  const k_tl_STAT1, k_tl_STAT2, k_tl_IRF9, k_tl_SOCS1, k_tl_SOCS3, k_tl_USP18, k_tl_IRF2;
  const k_deg_STAT1_mRNA, k_deg_STAT2_mRNA, k_deg_IRF9_mRNA;
  const k_deg_SOCS1_mRNA_basal, k_deg_SOCS1_mRNA_IRF2, k_deg_SOCS3_mRNA, k_deg_USP18_mRNA, k_deg_IRF2_mRNA;
  const k_deg_prot, k_deg_SOCS1, k_deg_SOCS3, k_deg_USP18, k_deg_IRF2;

  //// Unit definitions:
  unit substance = 1 item;
  unit time_unit = 3600 second;

  //// Display Names:
  time_unit is "hour";
  IFN_param is "IFNalpha concentration";
  Rec is "IFNalpha Receptor Complex";
  aRecIFN is "Activated IFNalpha Receptor Complex";
  STAT1c is "Cytoplasmic STAT1";
  STAT2c is "Cytoplasmic STAT2";
  IRF9c is "Cytoplasmic IRF9";
  STAT1n is "Nuclear STAT1";
  STAT2n is "Nuclear STAT2";
  IRF9n is "Nuclear IRF9";
  pSTAT1dimc is "Cytoplasmic pSTAT1 homodimer";
  pSTAT1pSTAT2c is "Cytoplasmic pSTAT1:pSTAT2 heterodimer";
  ISGF3c is "Cytoplasmic ISGF3 complex";
  pSTAT1dimn is "Nuclear pSTAT1 homodimer";
  pSTAT1pSTAT2n is "Nuclear pSTAT1:pSTAT2 heterodimer";
  ISGF3n is "Nuclear ISGF3 complex";
  OccGASbs is "Occupied GAS binding sites";
  OccGAS_ISREbs is "Occupied GAS-ISRE binding sites";
  SOCS1 is "Suppressor of cytokine signaling 1";
  SOCS3 is "Suppressor of cytokine signaling 3";
  USP18 is "Ubiquitin Specific Peptidase 18";
  IRF2 is "Interferon regulatory factor 2";
end
