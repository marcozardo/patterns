model *Malkov2020_COVID19_SEIRS_Reinfection()
  // Compartments and Species:
  compartment population;
  species S in population, E in population, I in population, R in population;
  species Sp in population, Ss in population, Ep in population, Es in population, Ip in population, Is in population;

  // Assignment Rules:
  R_tilde := (R_tilde1 + R_tilde2)/2;
  beta := gamma * R_tilde;

  // Rate Rules:
  R_tilde1' = -eta1 * (R_tilde1 - R1_star);
  R_tilde2' = -eta2 * (R_tilde2 - R2_star);

  // Reactions:
  Infection: S + I => E + I; beta*S*I;
  Progression: E => I; sigma*E;
  Recovery: I => R; gamma*I;
  ImmunityLoss: R => S; omega*R;
  
  // Alternative model reactions (milder reinfection):
  PrimaryInfection: Sp + Ip => Ep + Ip; beta_p*Sp*Ip;
  PrimaryInfection2: Sp + Is => Ep + Is; beta_s*Sp*Is;
  SecondaryInfection: Ss + Ip => Es + Ip; beta_p*Ss*Ip;
  SecondaryInfection2: Ss + Is => Es + Is; beta_s*Ss*Is;
  PrimaryProgression: Ep => Ip; sigma_p*Ep;
  SecondaryProgression: Es => Is; sigma_s*Es;
  PrimaryRecovery: Ip => R; gamma_p*Ip;
  SecondaryRecovery: Is => R; gamma_s*Is;
  SecondaryImmunityLoss: R => Ss; omega*R;

  // Species initializations:
  S = 0.998;
  E = 0.04375;
  I = 0.001;
  R = 0;
  Sp = 0.998;
  Ss = 0;
  Ep = 0.04375;
  Es = 0;
  Ip = 0.001;
  Is = 0;

  // Compartment initializations:
  population = 1;

  // Variable initializations:
  // Basic parameters
  sigma = 1/5.2;
  gamma = 1/18;
  
  // Immunity waning rates considered
  omega_365 = 1/365;
  omega_183 = 1/183;
  omega_120 = 1/120;
  omega_60 = 1/60;
  omega_0 = 0;
  
  // Basic reproduction numbers considered
  R0_16 = 1.6;
  R0_18 = 1.8;
  R0_20 = 2.0;
  R0_22 = 2.2;
  R0_25 = 2.5;
  R0_28 = 2.8;
  R0_30 = 3.0;
  
  // Time-varying reproduction number parameters
  R_tilde1_0 = 3;
  R_tilde2_0 = 3;
  R1_star = 1.6;
  R2_star = 1.6;
  
  // Convergence rates for different scenarios
  eta_very_fast = 1/5;
  eta_fast = 1/10;
  eta_moderate = 1/20;
  eta_slow = 1/50;
  eta_very_slow = 1/100;
  
  // Alternative model parameters (milder reinfection)
  beta_p = 1/6;
  beta_s = beta_p/2;
  sigma_p = 1/5.2;
  sigma_s = sigma_p;
  gamma_p = 1/18;
  gamma_s = 2*gamma_p;

  // Rate rule parameters
  eta1 = eta_moderate;
  eta2 = eta_moderate;

  // Other declarations:
  var R_tilde, beta, R_tilde1, R_tilde2;
  const population, sigma, gamma;
  const omega_365, omega_183, omega_120, omega_60, omega_0;
  const R0_16, R0_18, R0_20, R0_22, R0_25, R0_28, R0_30;
  const R_tilde1_0, R_tilde2_0, R1_star, R2_star;
  const eta_very_fast, eta_fast, eta_moderate, eta_slow, eta_very_slow;
  const beta_p, beta_s, sigma_p, sigma_s, gamma_p, gamma_s;
  const eta1, eta2;

  // Unit definitions:
  unit time_unit = 86400 second;
  unit population_unit = 1;

  // Display Names:
  time_unit is "day";
  population is "Total population";
  S is "Susceptible";
  E is "Exposed";
  I is "Infected";
  R is "Recovered";
  Sp is "Primary susceptible";
  Ss is "Secondary susceptible";
  Ep is "Primary exposed";
  Es is "Secondary exposed";
  Ip is "Primary infected";
  Is is "Secondary infected";
  Infection is "Infection process";
  Progression is "Disease progression";
  Recovery is "Recovery process";
  ImmunityLoss is "Immunity waning";
  PrimaryInfection is "Primary infection";
  SecondaryInfection is "Secondary infection";
end
