/* Domain: Molecular/cellular immunology (macrophage polarization via STAT1/STAT6 signaling)
   Source: Frank et al., Journal of Theoretical Biology 509 (2021) 110511
   Model: Two-dimensional ODEs for activated STAT1 (x1) and STAT6 (x2) with asymmetric mutual inhibition and self-stimulation.
*/

model *Frank2021_MacrophagePolarization()

  //// Compartments and Species:
  compartment cell;
  species $x1 in cell, $x2 in cell;

  //// Assignment Rules:
  Hplus1 := x1^n1/(x1^n1 + k1^n1);
  Hminus2 := p2^l2/(p2^l2 + x2^l2);
  Hplus2 := x2^n2/(x2^n2 + k2^n2);
  Hminus1 := p1^l1/(p1^l1 + x1^l1);

  //// Rate Rules:
  x1' = (a1*Hplus1 + S1)*Hminus2 + b1 - q1*x1;
  x2' = a2*Hplus2 + S2*Hminus1 + b2 - q2*x2;

  //// Species initializations:
  x1 = 0;   // activated STAT1 (dimensionless)
  x2 = 0;   // activated STAT6 (dimensionless)

  //// Compartment initializations:
  cell = 1;

  //// Variable initializations:
  a1 = 5;
  a2 = 5;
  b1 = 0.05;
  b2 = 0.05;
  n1 = 6;
  n2 = 6;
  k1 = 1;
  k2 = 1;
  l1 = 1;
  l2 = 1;
  p1 = 0.5;
  p2 = 1;
  q1 = 5;
  q2 = 5;
  S1 = 3.75;
  S2 = 3.75;

  //// Other declarations:
  var Hplus1, Hplus2, Hminus1, Hminus2;
  const cell, a1, a2, b1, b2, n1, n2, k1, k2, l1, l2, p1, p2, q1, q2, S1, S2;

  //// Display Names:
  cell is "Macrophage (well-mixed) compartment";
  x1 is "Activated STAT1 level (proxy for M1)";
  x2 is "Activated STAT6 level (proxy for M2)";
  Hplus1 is "Hill stim of STAT1 by STAT1";
  Hplus2 is "Hill stim of STAT6 by STAT6";
  Hminus1 is "Hill inhib of STAT6 input by STAT1";
  Hminus2 is "Hill inhib of STAT1 input/self by STAT6";
  a1 is "Self-stimulation strength STAT1 (1/day)";
  a2 is "Self-stimulation strength STAT6 (1/day)";
  b1 is "Basal activation STAT1 (1/day)";
  b2 is "Basal activation STAT6 (1/day)";
  n1 is "Hill exponent self-stimulation STAT1";
  n2 is "Hill exponent self-stimulation STAT6";
  k1 is "Half-max threshold self-stimulation STAT1";
  k2 is "Half-max threshold self-stimulation STAT6";
  l1 is "Hill exponent mutual inhibition on STAT6 input";
  l2 is "Hill exponent mutual inhibition on STAT1";
  p1 is "Threshold mutual inhibition by STAT1";
  p2 is "Threshold mutual inhibition by STAT6";
  q1 is "Deactivation rate STAT1 (1/day)";
  q2 is "Deactivation rate STAT6 (1/day)";
  S1 is "IFN-gamma input strength (1/day)";
  S2 is "IL-4 input strength (1/day)";
end

/* Alternative parameter sets reported (not activated in the model above):
   Theta_1:
     a1=5, a2=5, b1=0.05, b2=0.05, n1=6, n2=6, k1=1, k2=1, l1=1, l2=1, p1=0.5, p2=1, q1=5, q2=5, S1=4, S2=4.
   Theta_2:
     a1=15, a2=8, b1=0.05, b2=0.05, n1=22, n2=6, k1=1, k2=1, l1=1, l2=1, p1=0.5, p2=1, q1=5.8, q2=5.8, S1=5, S2=5.
*/
