model *Hsp70_Heat_Shock_Response()

  // Compartments and Species:
  compartment compartment_;
  species HSP in compartment_, HSF in compartment_, S in compartment_, HSP_HSF in compartment_;
  species HSP_S in compartment_, HSF3 in compartment_, HSE in compartment_, HSE_HSF3 in compartment_;
  species mRNA in compartment_, P in compartment_;

  // Assignment Rules:
  I_Neg7 := l7_T;  # HSE:HSF3 dissociation rate constant (temperature dependent)
  k8_T := k8_max * (1 - 1/(1 + exp(-R_k8*(T - T_k8))));  # Temperature-dependent transcription rate
  V_den_T := 1 - (1 + ((T - T0)/(T_05 - T0))^nV)^-1;  # Fraction of denatured proteins (Hill function)
  k11_T := k10 * V_den_T / (1 - V_den_T);  # Temperature-dependent denaturation rate constant

  // Rate Rules:
  HSP' = -l3*HSF3*HSP - k1*HSP*S + l1*HSP_S - k2*HSF*HSP + l2*HSP_HSF - k9*HSP + k10*HSP_S + k4*mRNA + k6;
  HSF' = -3*k3*HSF^3 + 2*l3*HSF3*HSP - k2*HSF*HSP + l2*HSP_HSF;
  S' = -k1*HSP*S + l1*HSP_S + k11_T*P;
  HSP_HSF' = k2*HSF*HSP - l2*HSP_HSF + l3*HSF3*HSP;
  HSP_S' = k1*HSP*S - l1*HSP_S - k10*HSP_S;
  HSF3' = k3*HSF^3 - l3*HSF3*HSP - k7*HSE*HSF3 + I_Neg7*HSE_HSF3;
  HSE' = -k7*HSE*HSF3 + l7_T*HSE_HSF3;
  HSE_HSF3' = k7*HSE*HSF3 - I_Neg7*HSE_HSF3;
  mRNA' = k8_T*HSE_HSF3 - k5*mRNA;
  P' = k10*HSP_S - k11_T*P;

  // Reactions:
  // (Reactions are embedded in rate rules above as ODEs; no explicit reaction block needed)

  // Species initializations:
  HSP = 52.077;       # ?M, total initial HSP concentration
  HSF = 0.001363;     # ?M, initial free HSF monomer concentration
  S = 8.122e-08;      # ?M, initial denatured protein concentration (substrate)
  HSP_HSF = 0.01429;  # ?M, initial HSP:HSF complex
  HSP_S = 0.0005268;  # ?M, initial HSP:S complex
  HSF3 = 9.082e-06;   # ?M, initial HSF trimer concentration
  HSE = 3.996e-06;    # ?M, initial free HSE concentration
  HSE_HSF3 = 4.484e-09; # ?M, initial transcriptional complex concentration
  mRNA = 0.0004946;   # ?M, initial mRNA concentration
  P = 1297;           # ?M, initial native protein concentration

  // Compartment initializations:
  compartment_ = 1;   # Unit volume (arbitrary units)

  // Variable initializations:
  k1 = 12.6;          # ?M^-1 min^-1, HSP:S association rate constant
  l1 = 0.003028;      # min^-1, HSP:S dissociation rate constant
  k2 = 0.218;         # ?M^-1 min^-1, HSP:HSF association rate constant
  l2 = 1.162;         # min^-1, HSP:HSF dissociation rate constant
  k3 = 4.465e+05;     # ?M^-2 min^-1, HSF trimerization rate constant
  l3 = 2.392;         # ?M^-1 min^-1, HSF3 inactivation rate constant
  k4 = 18.85;         # min^-1, translation rate constant
  k5 = 0.0008709;     # min^-1, mRNA degradation rate constant
  k6 = 0.08899;       # min^-1, constitutive HSP production rate
  k7 = 5892;          # ?M^-1 min^-1, HSE:HSF3 association rate constant
  l7_T = 47.68;       # min^-1, HSE:HSF3 dissociation rate constant at T nodes (interpolated)
  k8_max = 96.07;     # min^-1, maximal transcription rate constant
  R_k8 = 15.93;       # unitless, transcription temperature dependence parameter
  T_k8 = 42.89;       # ?C, transcription temperature dependence midpoint
  k9 = 0.001888;      # min^-1, HSP degradation rate constant
  k10 = 0.09813;      # min^-1, protein refolding rate constant
  # k11_T is temperature-dependent, defined via assignment rule
  # l7_T is temperature-dependent, linear interpolation between specified temperature nodes

  T = 37;             # ?C, initial temperature (can be varied for simulations)
  T0 = 35.81;         # ?C, denaturation model parameter (start of denaturation)
  T_05 = 47.13;       # ?C, denaturation model parameter (half-max denaturation)
  nV = 6.522;         # unitless, Hill coefficient for denaturation

  P_tot = 1297;       # ?M, total denaturation-susceptible proteins (conserved)
  HSF_tot = 0.01568;  # ?M, total heat shock factor 1 (conserved)
  HSE_tot = 4e-06;    # ?M, total heat shock elements (conserved)

  // Other declarations:
  var I_Neg7, k8_T, V_den_T, k11_T;
  const compartment_, k1, l1, k2, l2, k3, l3, k4, k5, k6, k7, l7_T, k8_max, R_k8, T_k8, k9, k10;
  const T, T0, T_05, nV, P_tot, HSF_tot, HSE_tot;

  // Unit definitions:
  unit time = 1 minute;
  unit concentration = 1e-6 mole / litre;  # ?M

  // Display Names:
  compartment_ is "Intracellular compartment";
  HSP is "Heat shock proteins (HSP70, Hsc70, Hsp90 combined)";
  HSF is "Heat shock factor 1 monomer";
  S is "Denatured proteins (substrate)";
  HSP_HSF is "HSP:HSF complexes";
  HSP_S is "HSP:substrate complexes";
  HSF3 is "HSF trimers (active HSF)";
  HSE is "Heat shock elements (DNA promoter sites)";
  HSE_HSF3 is "Transcriptional complexes (HSE:HSF3)";
  mRNA is "Hsp70 mRNA";
  P is "Native proteins";

  k1 is "HSP:substrate association rate constant";
  l1 is "HSP:substrate dissociation rate constant";
  k2 is "HSP:HSF association rate constant";
  l2 is "HSP:HSF dissociation rate constant";
  k3 is "HSF trimerization rate constant";
  l3 is "HSF3 inactivation rate constant";
  k4 is "Translation rate constant";
  k5 is "mRNA degradation rate constant";
  k6 is "Constitutive HSP production rate";
  k7 is "HSE:HSF3 association rate constant";
  l7_T is "HSE:HSF3 dissociation rate constant (temperature dependent)";
  k8_max is "Maximal transcription rate constant";
  R_k8 is "Transcription temperature dependence parameter";
  T_k8 is "Transcription temperature dependence midpoint";
  k9 is "HSP degradation rate constant";
  k10 is "Protein refolding rate constant";

  P_tot is "Total denaturation-susceptible proteins";
  HSF_tot is "Total heat shock factor 1";
  HSE_tot is "Total heat shock elements";

end
