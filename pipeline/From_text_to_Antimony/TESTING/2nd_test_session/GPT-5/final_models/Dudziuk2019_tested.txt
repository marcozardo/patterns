model *Dudziuk2019_Hsp70_HSR()

  // Compartments and Species:
  compartment cell;
  species HSP in cell, HSF in cell, S in cell, HSP_HSF in cell, HSP_S in cell;
  species HSF3 in cell, HSE in cell, HSE_HSF3 in cell, mRNA in cell, P in cell;
  species $EmptySet in cell;

  // Assignment Rules:
  // Temperature-dependent dissociation of HSE:HSF3 (linear interpolation on [37,45] C)
  l7_T := piecewise(l7_37 + (l7_41 - l7_37)*(T - 37)/(41 - 37), (T >= 37) and (T <= 41), l7_41 + (l7_42 - l7_41)*(T - 41)/(42 - 41), (T > 41) and (T <= 42), l7_42 + (l7_43 - l7_42)*(T - 42)/(43 - 42), (T > 42) and (T <= 43), l7_43 + (l7_44 - l7_43)*(T - 43)/(44 - 43), (T > 43) and (T <= 44), l7_44 + (l7_45 - l7_44)*(T - 44)/(45 - 44), (T > 44) and (T <= 45), l7_37);
  // Temperature-dependent transcription rate (sigmoid)
  k8_T := k8_max * (1 - 1/(1 + exp(-R_k8 * (T - T_k8))));
  // Fractional denaturation (Hill function) and denaturation rate
  V_den_T := 1 - (1 + ((T - T0_den)/(T05_den - T0_den))^n_v)^(-1);
  k11_T := k10 * (V_den_T/(1 - V_den_T));

  // Reactions:
  R1_HSF_trimerization: 3 HSF => HSF3; k3*HSF^3;
  R2_HSF3_bind_HSE: HSF3 + HSE -> HSE_HSF3; k7*HSF3*HSE;
  R3_HSE_HSF3_dissoc: HSE_HSF3 -> HSF3 + HSE; l7_T*HSE_HSF3;
  R4_Transcription: HSE_HSF3 => HSE_HSF3 + mRNA; k8_T*HSE_HSF3;
  R5_HSF_inactivation: HSP + HSF3 => HSP_HSF + 2 HSF; l3*HSP*HSF3;
  R6_HSP_S_assoc: HSP + S -> HSP_S; k1*HSP*S;
  R7_HSP_S_dissoc: HSP_S -> HSP + S; l1*HSP_S;
  R8_HSP_degradation: HSP -> ; k9*HSP;
  R9_Refolding: HSP_S => HSP + P; k10*HSP_S;
  R10_Denaturation: P => S; k11_T*P;
  R11_Translation: mRNA => mRNA + HSP; k4*mRNA;
  R12_Constitutive_HSP_inflow: $EmptySet => HSP; k6;

  // Species initializations:
  HSP = 52.06;
  HSF = 0.001363;
  S = 8.122e-08;
  HSP_HSF = 0.01429;
  HSP_S = 0.0005268;
  HSF3 = 9.082e-06;
  HSE = 3.996e-06;
  HSE_HSF3 = 4.484e-09;
  mRNA = 0.0004946;
  P = 1297;
  EmptySet = 0;

  // Compartment initializations:
  cell = 1;

  // Variable initializations:
  // Temperature (C)
  T = 37;
  // Kinetic parameters (temperature-independent)
  k1 = 12.60;
  l1 = 0.003028;
  k2 = 0.2180;
  l2 = 1.162;
  k3 = 4.465e+05;
  l3 = 2.392;
  k4 = 18.85;
  k5 = 0.0008709;
  k6 = 0.08899;
  k7 = 5892;
  k9 = 0.001888;
  k10 = 0.09813;
  // Temperature-dependent parameter nodes for l7_T (min^-1) at T = 37,41,42,43,44,45 C
  l7_37 = 47.68;
  l7_41 = 1.233;
  l7_42 = 0.6628;
  l7_43 = 0.01639;
  l7_44 = 50.01;
  l7_45 = 84.27;
  // Transcription temperature-dependence parameters
  k8_max = 96.07;
  R_k8 = 15.93;
  T_k8 = 42.89;
  // Fractional denaturation parameters
  T0_den = 35.81;
  T05_den = 47.13;
  n_v = 6.522;
  // Conserved totals (for reference)
  P_tot = 1297;
  HSF_tot = 0.01568;
  HSE_tot = 4.0e-06;

  // Other declarations:
  var l7_T, k8_T, V_den_T, k11_T, T;
  const cell, k1, l1, k2, l2, k3, l3, k4, k5, k6, k7, k9, k10;
  const l7_37, l7_41, l7_42, l7_43, l7_44, l7_45;
  const k8_max, R_k8, T_k8;
  const T0_den, T05_den, n_v;
  const P_tot, HSF_tot, HSE_tot;

  // Unit definitions:
  unit substance = 1e-6 mole;
  unit time_unit = 60 second;

  // Display Names:
  cell is "compartment";
  HSP is "Heat shock proteins (Hsp70 family pool)";
  HSF is "Heat shock factor 1 (monomer)";
  HSF3 is "HSF trimers (active)";
  HSE is "Heat shock element";
  HSE_HSF3 is "Transcriptional complex";
  mRNA is "Hsp70 mRNA";
  S is "Denatured proteins (substrate)";
  P is "Native proteins";
  HSP_HSF is "HSP:HSF complex";
  HSP_S is "HSP:substrate complex";
  R1_HSF_trimerization is "HSF activation (trimerisation)";
  R2_HSF3_bind_HSE is "HSF3-to-DNA binding";
  R3_HSE_HSF3_dissoc is "HSE:HSF3 dissociation (temp-dependent)";
  R4_Transcription is "Transcription of Hsp70 mRNA";
  R5_HSF_inactivation is "HSF inactivation by HSP";
  R6_HSP_S_assoc is "HSP-to-substrate association";
  R7_HSP_S_dissoc is "HSP-to-substrate dissociation";
  R8_HSP_degradation is "HSP degradation";
  R9_Refolding is "Protein refolding";
  R10_Denaturation is "Protein denaturation (temp-dependent)";
  R11_Translation is "Translation to HSP";
  R12_Constitutive_HSP_inflow is "Constitutive HSP production";
end
