model *Schmierer2010_HIF_ARD_Interaction()

  //// Compartments and Species:
  compartment cell;
  species H_tot in cell, H in cell, H_OH in cell;
  species A in cell, A_OH in cell;
  species $P_tot in cell, $F_tot in cell, $A_tot in cell, $O2 in cell;

  //// Assignment Rules:
  // HIF? conservation
  H_OH := H_tot - H;
  
  // ARD protein conservation  
  A_OH := A_tot - A;
  
  // PHD-HIF? complex (Equation 5)
  A_P := -0.5 * (H_tot - P_tot - K_D_P + sqrt((K_D_P + P_tot - H_tot)^2 + 4*K_D_P*H_tot));
  
  // Free HIF? for PHD binding
  H_p := H_tot - A_P;
  
  // Inhibitory constant for FIH (Equation 8)
  K_i_FH := K_D_FH * (1 + A/K_D_FA + gamma*A_OH/K_D_FA);
  
  // FIH-HIF? complex (Equation 7)
  A_F := 0.5 * (H - F_tot - K_i_FH + sqrt((K_i_FH + F_tot - H)^2 + 4*K_i_FH*H));
  
  // Free HIF? for FIH binding
  H_F := H - A_F;
  
  // Hydroxylation rate functions (dimensionless)
  v_P := k_cat_P * P_tot * (1/(K_D_P + H_p + P_tot)) * (O2_tilde/(1 + O2_tilde));
  v_FH := k_cat_FH * F_tot * (1/(K_i_FH + H_F + F_tot)) * (O2_tilde/(alpha + O2_tilde));
  v_FA := (k_cat_FA * F_tot)/(K_D_FA * (1 + H_F/K_D_FH) + A + gamma*A_OH) * (O2_tilde/(alpha + O2_tilde));
  
  // Free FIH fraction (SKM2)
  F_free := 1/(1 + kappa*A);
  
  // HRE occupancy probabilities
  HRE_CAD := H/(K_D_HRE + H_tot);
  HRE_CADOH := H_OH/(K_D_HRE + H_tot);

  //// Rate Rules:
  // Full Model ODEs (Equations 1-3)
  H_tot' = 1 - H_tot*(1 + v_P);
  H' = 1 - H*(1 + v_P + v_FH);
  A' = (A_tot - A*(1 + epsilon*v_FA))/epsilon;

  //// Species initializations:
  H_tot = 0;
  H = 0;
  A = 0;

  //// Compartment initializations:
  cell = 1;

  //// Variable initializations:
  // Default parameter values from Table 2
  P_tot = 0.2;
  K_D_P = 1;
  k_cat_P = 500;
  F_tot = 1;
  K_D_FH = 1;
  alpha = 0.33;
  k_cat_FH = 500;
  A_tot = 100;
  K_D_FA = 1;
  gamma = 0.02;
  epsilon = 5;
  K_D_HRE = 0.3;
  O2_tilde = 0.1;
  
  // SKM2 parameters
  kappa = A_tot/K_D_FA;
  beta = (k_cat_FA * F_tot)/(k_d_A * A_tot);
  k_cat_FA = 500;
  k_d_A = 1;

  //// Other declarations:
  var H_tot, H, H_OH, A, A_OH;
  var A_P, H_p, K_i_FH, A_F, H_F, v_P, v_FH, v_FA, F_free, HRE_CAD, HRE_CADOH;
  const P_tot, F_tot, A_tot, O2_tilde, K_D_P, k_cat_P, K_D_FH, k_cat_FH, K_D_FA;
  const k_cat_FA, alpha, gamma, epsilon, K_D_HRE, kappa, beta, k_d_A;

  //// Unit definitions:
  unit substance = 1e-9 mole;
  unit time_unit = 1 second;
  unit concentration = 1e-9 mole / liter;

  //// Display Names:
  cell is "Intracellular compartment";
  H_tot is "Total HIF?";
  H is "Non-CAD-hydroxylated HIF?";
  H_OH is "CAD-hydroxylated HIF?";
  A is "Unhydroxylated ARD proteins";
  A_OH is "Hydroxylated ARD proteins";
  P_tot is "Total PHD concentration";
  F_tot is "Total FIH concentration";
  A_tot is "Total ARD protein concentration";
  O2_tilde is "Oxygen concentration (relative to K_M^P)";
  v_P is "PHD-dependent HIF? ODD-hydroxylation rate";
  v_FH is "FIH-dependent HIF? CAD-hydroxylation rate";
  v_FA is "FIH-dependent ARD protein hydroxylation rate";
  F_free is "Free FIH fraction";
  HRE_CAD is "HRE occupancy by non-CAD-hydroxylated HIF?";
  HRE_CADOH is "HRE occupancy by CAD-hydroxylated HIF?";

end
