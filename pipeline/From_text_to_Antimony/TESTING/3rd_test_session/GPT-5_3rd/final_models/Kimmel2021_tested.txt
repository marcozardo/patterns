model *Kimmel2021_CART_Gompertz()

  //// Compartments and Species:
  compartment system;
  species N in system, C in system, B in system;

  //// Assignment Rules:
  T := N + C;  // total lymphocytes
  rC := rho_C + b*(T - K_N)^2 / (a*T^2 + (T - K_N)^2);  // CAR T turnover modulation by total T cell count

  //// Rate Rules:
  N' = - r_N*N*ln((N + C)/K_N);
  C' = - rC*C*ln((N + C)/K_C);
  B' = r_B*B - gamma_B*B*(C/(k_B + C));

  //// Species initializations:
  N = 3.0e9;        // cells
  C = 1.8e8;        // cells
  B = 9.486e10;     // cells

  //// Compartment initializations:
  system = 1;

  //// Variable initializations:
  K_N = 2.5e11;     // cells
  K_C = 6.96e10;    // cells
  r_N = 1.70e-1;    // day^-1
  rho_C = 2.51e-2;  // day^-1
  a = 4.23e-1;      // dimensionless
  b = 5.25e-1;      // day^-1
  r_B = 0.19;       // day^-1 (typical "medium" intrinsic tumour growth rate used in simulations)
  gamma_B = 1.15;   // day^-1
  k_B = 2.024e9;    // cells

  //// Other declarations:
  var T, rC;
  const system, K_N, K_C, r_N, rho_C, a, b, r_B, gamma_B, k_B;

  //// Display Names:
  system is "System volume (arbitrary, set to 1)";
  N is "Normal T cells";
  C is "CAR T cells";
  B is "CD19+ tumour cells";
  T is "Total lymphocytes (N + C)";
  rC is "Effective CAR T net turnover rate";
  K_N is "Normal T carrying capacity";
  K_C is "CAR T carrying capacity";
  r_N is "Normal T net growth rate";
  rho_C is "Baseline CAR T net growth rate";
  a is "Signalling inefficiency factor in r_C";
  b is "Immune reconstitution impact in r_C";
  r_B is "Tumour net growth rate";
  gamma_B is "Tumour-killing rate by CAR T";
  k_B is "Killing saturation parameter";

end
