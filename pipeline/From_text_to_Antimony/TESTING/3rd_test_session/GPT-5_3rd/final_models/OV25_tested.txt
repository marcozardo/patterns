model *OV_DC_Tumor_Original()

  //// Compartments and Species:
  compartment tumor;
  species U in tumor, I in tumor, V in tumor, T in tumor, A in tumor, D in tumor;

  //// Assignment Rules:
  N := U + I + T;  # total volume of tumor and tumor-targeting T cells
  # Time-dependent OV dosing u_V(t) as short infusions at t = 0, 2, 4 days
  u_V := (dose_V1/tauV)*piecewise(1, (time >= tV1) && (time < tV1 + tauV), 0) + (dose_V2/tauV)*piecewise(1, (time >= tV2) && (time < tV2 + tauV), 0) + (dose_V3/tauV)*piecewise(1, (time >= tV3) && (time < tV3 + tauV), 0);
  # Time-dependent DC dosing u_D(t) as short infusions at t = 1, 3, 5 days
  u_D := (dose_D1/tauD)*piecewise(1, (time >= tD1) && (time < tD1 + tauD), 0) + (dose_D2/tauD)*piecewise(1, (time >= tD2) && (time < tD2 + tauD), 0) + (dose_D3/tauD)*piecewise(1, (time >= tD3) && (time < tD3 + tauD), 0);

  //// Rate Rules:
  U' = r*U - beta*U*V/N - (kappa_0 + c_kill*I)*(U*T/N);
  I' = beta*U*V/N - delta_I*I - (kappa_0 + c_kill*I)*(I*T/N);
  V' = u_V + alpha*delta_I*I - delta_V*V;
  T' = c_T*I + chi_A*A + chi_D*D - delta_T*T;
  A' = c_A*I - delta_A*A;
  D' = u_D - delta_D*D;

  //// Species initializations:
  U = U0;   # initial uninfected tumor volume
  I = 0;
  V = 0;
  T = 0;
  A = 0;
  D = 0;

  //// Compartment initializations:
  tumor = 1;

  //// Variable initializations:
  # Initial condition parameter:
  U0 = 1;

  # Core dynamics (selected best-fit values reported in the paper where unambiguous; others set to 0 by default and should be specified when fitting/using the model):
  r = 0.3198;         // tumor exponential growth rate (best-fit)
  beta = 0.00100854;  // infection rate (mapped from text; see note after model)
  kappa_0 = 0;
  c_kill = 5.954e7;   // IL-12/4-1BBL-enhanced kill coefficient (best-fit)
  delta_I = 0;
  alpha = 0;
  delta_V = 0;
  c_T = 1.6984;       // I-driven T cell recruitment rate (best-fit)
  chi_A = 0;
  chi_D = 0;
  delta_T = 0;
  c_A = 0.000517;     // IL-12-induced activation of naive T cells (best-fit)
  delta_A = 0;
  delta_D = 4.6754;   // DC decay rate (best-fit)

  # Dosing schedule (days) and infusion durations (days):
  tV1 = 0;  tV2 = 2;  tV3 = 4;  // OV injections on days 0, 2, 4
  tD1 = 1;  tD2 = 3;  tD3 = 5;  // DC injections on days 1, 3, 5
  tauV = 0.01;  tauD = 0.01;    // short infusion windows (default 0.01 day)

  # Doses (amount units consistent with V and D state variables):
  dose_V1 = 0;  dose_V2 = 0;  dose_V3 = 0;
  dose_D1 = 0;  dose_D2 = 0;  dose_D3 = 0;

  //// Other declarations:
  var N, u_V, u_D;
  const tumor, U0, r, beta, kappa_0, c_kill, delta_I, alpha, delta_V, c_T, chi_A, chi_D, delta_T, c_A, delta_A, delta_D, tV1, tV2, tV3, tD1, tD2, tD3, tauV, tauD, dose_V1, dose_V2, dose_V3, dose_D1, dose_D2, dose_D3;

  //// Display Names:
  tumor is "Tumor compartment (volume units)";
  U is "Uninfected tumor cell volume";
  I is "Infected tumor cell volume";
  V is "Free virions";
  T is "Tumor-targeting T cells";
  A is "Naive T cells";
  D is "Injected dendritic cells";
  N is "Total cell volume (U + I + T)";
  u_V is "Oncolytic virus dosing rate";
  u_D is "Dendritic cell dosing rate";
  r is "Tumor growth rate";
  beta is "OV infection rate";
  kappa_0 is "Baseline T cell kill rate";
  c_kill is "Kill coefficient enhanced by I (IL-12/4-1BBL)";
  delta_I is "Infected cell death/lysis rate";
  alpha is "Virions released per lysed infected cell (scaled)";
  delta_V is "Virion clearance rate";
  c_T is "I-driven T cell recruitment rate";
  chi_A is "Naive-to-T differentiation drive";
  chi_D is "DC-driven T production rate";
  delta_T is "T cell death rate";
  c_A is "IL-12-induced naive T activation rate";
  delta_A is "Naive T death rate";
  delta_D is "DC decay rate";
  tV1 is "Day of OV dose 1";
  tV2 is "Day of OV dose 2";
  tV3 is "Day of OV dose 3";
  tD1 is "Day of DC dose 1";
  tD2 is "Day of DC dose 2";
  tD3 is "Day of DC dose 3";
  tauV is "OV infusion duration (days)";
  tauD is "DC infusion duration (days)";
  dose_V1 is "OV dose 1 (amount units)";
  dose_V2 is "OV dose 2 (amount units)";
  dose_V3 is "OV dose 3 (amount units)";
  dose_D1 is "DC dose 1 (amount units)";
  dose_D2 is "DC dose 2 (amount units)";
  dose_D3 is "DC dose 3 (amount units)";
end

/* Notes on mapping and usage:

- The system encoded is the original 6-ODE model (Equations (1)-(6)) with explicit time-dependent inputs u_V(t) and u_D(t), implemented as short infusions at the experimental schedule (OV at days 0,2,4; DC at days 1,3,5). Adjust times, durations (tauV, tauD), and doses (dose_*) to match specific protocols. Setting dose_* = 0 produces no dosing.

- The total cell "density" N is defined as stated in the text: the sum of tumor cells (U + I) and tumor-targeting T cells (T).

- Parameter values: r, c_A, c_T, c_kill, and delta_D default to best-fit values explicitly reported in the paper?s tables/figures. The symbol ??? reported with best-fit value 0.00100854 was not explicitly labeled in the provided excerpt. Here it is mapped to beta (infection rate) to provide a working default; replace as appropriate if a different mapping is intended. All other parameters are initialized to 0 by default and should be set during calibration.

- Important numerical caution: If U, I, and T all reach zero, N = 0 and terms U*V/N, U*T/N, I*T/N become undefined. This reflects the source model formulation. Users may add a small epsilon to N in those terms if needed for numerical robustness, but that would alter the original equations.

- Minimal model: The paper also proposes a reduced 5-ODE minimal model (Equations (15)-(19)) that removes A, c_A, chi_A, and delta_A by fixing c_A = 0. That alternative is not encoded here to keep a single model block; it can be obtained by setting c_A = 0 and chi_A = 0 and fixing A(0) = 0, which makes A remain identically zero, effectively reducing the dynamics to the minimal form.
*/
