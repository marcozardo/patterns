/* An in silico model of the ubiquitin-proteasome system that incorporates normal homeostasis and age-related decline
   Based on: Proctor et al. BMC Systems Biology 2007, 1:17
   This model represents the ubiquitin-proteasome pathway including protein synthesis, misfolding, 
   ubiquitination, deubiquitination, proteasomal degradation, and aggregation processes */

model *Proctor2007_UPS()

  //// Compartments and Species:
  compartment cell;
  species NatP in cell, MisP in cell, $Ub in cell, $E1 in cell, $E2 in cell, $E3 in cell;
  species $DUB in cell, $Proteasome in cell, $ROS in cell, $ATP in cell, $ADP in cell, $AMP in cell;
  species E3_MisP in cell, E1_Ub in cell, E2_Ub in cell, MisP_Ub in cell;
  species MisP_Ub2 in cell, MisP_Ub3 in cell, MisP_Ub4 in cell, MisP_Ub5 in cell;
  species MisP_Ub6 in cell, MisP_Ub7 in cell, MisP_Ub8 in cell;
  species MisP_Ub4_Proteasome in cell, MisP_Ub5_Proteasome in cell, MisP_Ub6_Proteasome in cell;
  species MisP_Ub7_Proteasome in cell, MisP_Ub8_Proteasome in cell;
  species AggP in cell, SeqAggP in cell, AggP_Proteasome in cell;
  species degUb4 in cell, degUb5 in cell, degUb6 in cell, degUb7 in cell, degUb8 in cell;

  //// Assignment Rules:
  // No assignment rules in basic model - all dynamics handled by reactions

  //// Rate Rules:
  // No rate rules in basic model - all dynamics handled by reactions

  //// Reactions:
  // Protein synthesis and folding
  R1: => NatP; k1;
  R2: NatP + ROS -> MisP + ROS; k2*NatP*ROS;
  R3: MisP -> NatP; k3*MisP;

  // E3 binding to misfolded protein
  R4: E3 + MisP -> E3_MisP; k61*E3*MisP;
  R5: E3_MisP -> E3 + MisP; k61r*E3_MisP;

  // Ubiquitin activation and transfer
  R6: E1 + Ub + ATP -> E1_Ub + AMP; k62*E1*Ub*(ATP/(5000+ATP));
  R7: E2 + E1_Ub -> E2_Ub + E1; k63*E2*E1_Ub;

  // Monoubiquitination
  R8: E2_Ub + E3_MisP -> MisP_Ub + E2 + E3; k64*E2_Ub*E3_MisP;

  // Polyubiquitination chain extension
  R9: MisP_Ub + E2_Ub -> MisP_Ub2 + E2; k65*MisP_Ub*E2_Ub;
  R10: MisP_Ub2 + E2_Ub -> MisP_Ub3 + E2; k65*MisP_Ub2*E2_Ub;
  R11: MisP_Ub3 + E2_Ub -> MisP_Ub4 + E2; k65*MisP_Ub3*E2_Ub;
  R12: MisP_Ub4 + E2_Ub -> MisP_Ub5 + E2; k65*MisP_Ub4*E2_Ub;
  R13: MisP_Ub5 + E2_Ub -> MisP_Ub6 + E2; k65*MisP_Ub5*E2_Ub;
  R14: MisP_Ub6 + E2_Ub -> MisP_Ub7 + E2; k65*MisP_Ub6*E2_Ub;
  R15: MisP_Ub7 + E2_Ub -> MisP_Ub8 + E2; k65*MisP_Ub7*E2_Ub;

  // De-ubiquitination of free chains
  R16: MisP_Ub8 + DUB -> MisP_Ub7 + Ub + DUB; k66*MisP_Ub8*DUB;
  R17: MisP_Ub7 + DUB -> MisP_Ub6 + Ub + DUB; k66*MisP_Ub7*DUB;
  R18: MisP_Ub6 + DUB -> MisP_Ub5 + Ub + DUB; k66*MisP_Ub6*DUB;
  R19: MisP_Ub5 + DUB -> MisP_Ub4 + Ub + DUB; k66*MisP_Ub5*DUB;
  R20: MisP_Ub4 + DUB -> MisP_Ub3 + Ub + DUB; k66*MisP_Ub4*DUB;
  R21: MisP_Ub3 + DUB -> MisP_Ub2 + Ub + DUB; k66*MisP_Ub3*DUB;
  R22: MisP_Ub2 + DUB -> MisP_Ub + Ub + DUB; k66*MisP_Ub2*DUB;
  R23: MisP_Ub + DUB -> MisP + Ub + DUB; k66*MisP_Ub*DUB;

  // Proteasome binding
  R24: MisP_Ub4 + Proteasome -> MisP_Ub4_Proteasome; k67*MisP_Ub4*Proteasome;
  R25: MisP_Ub5 + Proteasome -> MisP_Ub5_Proteasome; k67*MisP_Ub5*Proteasome;
  R26: MisP_Ub6 + Proteasome -> MisP_Ub6_Proteasome; k67*MisP_Ub6*Proteasome;
  R27: MisP_Ub7 + Proteasome -> MisP_Ub7_Proteasome; k67*MisP_Ub7*Proteasome;
  R28: MisP_Ub8 + Proteasome -> MisP_Ub8_Proteasome; k67*MisP_Ub8*Proteasome;

  // De-ubiquitination of bound substrates
  R29: MisP_Ub8_Proteasome + DUB -> MisP_Ub7_Proteasome + Ub + DUB; k68*MisP_Ub8_Proteasome*DUB;
  R30: MisP_Ub7_Proteasome + DUB -> MisP_Ub6_Proteasome + Ub + DUB; k68*MisP_Ub7_Proteasome*DUB;
  R31: MisP_Ub6_Proteasome + DUB -> MisP_Ub5_Proteasome + Ub + DUB; k68*MisP_Ub6_Proteasome*DUB;
  R32: MisP_Ub5_Proteasome + DUB -> MisP_Ub4_Proteasome + Ub + DUB; k68*MisP_Ub5_Proteasome*DUB;
  R33: MisP_Ub4_Proteasome + DUB -> MisP_Ub3 + Proteasome + Ub + DUB; k68*MisP_Ub4_Proteasome*DUB;

  // Proteasome degradation activity
  R34: MisP_Ub4_Proteasome + ATP -> Proteasome + 4*Ub + ADP + degUb4; k69*MisP_Ub4_Proteasome*(ATP/(5000+ATP));
  R35: MisP_Ub5_Proteasome + ATP -> Proteasome + 5*Ub + ADP + degUb5; k69*MisP_Ub5_Proteasome*(ATP/(5000+ATP));
  R36: MisP_Ub6_Proteasome + ATP -> Proteasome + 6*Ub + ADP + degUb6; k69*MisP_Ub6_Proteasome*(ATP/(5000+ATP));
  R37: MisP_Ub7_Proteasome + ATP -> Proteasome + 7*Ub + ADP + degUb7; k69*MisP_Ub7_Proteasome*(ATP/(5000+ATP));
  R38: MisP_Ub8_Proteasome + ATP -> Proteasome + 8*Ub + ADP + degUb8; k69*MisP_Ub8_Proteasome*(ATP/(5000+ATP));

  // Aggregation reactions
  R39: 2*MisP -> AggP; k71*MisP*(MisP-1)/2.0;
  R40: MisP + AggP -> 2*AggP; k71*MisP*AggP;
  
  // Additional aggregation reactions for ubiquitinated species (representative examples)
  R41: 2*MisP_Ub -> AggP; k72*MisP_Ub*(MisP_Ub-1)/2.0;
  R42: MisP_Ub + AggP -> 2*AggP; k72*MisP_Ub*AggP;
  R43: MisP + MisP_Ub -> AggP; k72*MisP*MisP_Ub;

  // Aggregate processing
  R44: AggP -> SeqAggP; k73*AggP;
  R45: AggP + Proteasome -> AggP_Proteasome; k74*AggP*Proteasome;

  //// Events:
  E1: at time >= 1800: k62 = 0;  // Shutting down E1 activity at 30 minutes

  //// Species initializations:
  NatP = 500;
  MisP = 0;
  Ub = 500;
  E1 = 100;
  E2 = 100;
  E3 = 100;
  DUB = 200;
  Proteasome = 100;
  ROS = 10;
  ATP = 10000;
  ADP = 1000;
  AMP = 1000;
  E3_MisP = 0;
  E1_Ub = 0;
  E2_Ub = 0;
  MisP_Ub = 0;
  MisP_Ub2 = 0;
  MisP_Ub3 = 0;
  MisP_Ub4 = 0;
  MisP_Ub5 = 0;
  MisP_Ub6 = 0;
  MisP_Ub7 = 0;
  MisP_Ub8 = 0;
  MisP_Ub4_Proteasome = 0;
  MisP_Ub5_Proteasome = 0;
  MisP_Ub6_Proteasome = 0;
  MisP_Ub7_Proteasome = 0;
  MisP_Ub8_Proteasome = 0;
  AggP = 0;
  SeqAggP = 0;
  AggP_Proteasome = 0;
  degUb4 = 0;
  degUb5 = 0;
  degUb6 = 0;
  degUb7 = 0;
  degUb8 = 0;

  //// Compartment initializations:
  cell = 1;

  //// Variable initializations:
  k1 = 0.01;
  k2 = 2.0e-6;
  k3 = 4.0e-6;
  k61 = 1.7e-5;
  k61r = 2.0e-4;
  k62 = 2.0e-4;
  k63 = 1.0e-3;
  k64 = 1.0e-3;
  k65 = 1.0e-2;
  k66 = 1.0e-5;
  k67 = 1.0e-5;
  k68 = 1.0e-5;
  k69 = 1.0e-3;
  k71 = 1.0e-8;
  k72 = 1.0e-8;
  k73 = 1.0e-3;
  k74 = 1.0e-5;

  //// Other declarations:
  const cell, k1, k2, k3, k61, k61r, k62, k63, k64, k65, k66, k67, k68, k69, k71, k72, k73, k74;

  //// Unit definitions:
  unit substance = 1e-9 mole;
  unit time_unit = 1 second;

  //// Display Names:
  cell is "Cell";
  NatP is "Native Protein";
  MisP is "Misfolded Protein";
  Ub is "Ubiquitin";
  E1 is "Ubiquitin Activating Enzyme";
  E2 is "Ubiquitin Conjugating Enzyme";
  E3 is "Ubiquitin Ligase";
  DUB is "De-ubiquitinating Enzyme";
  Proteasome is "Proteasome";
  ROS is "Reactive Oxygen Species";
  ATP is "Adenosine Triphosphate";
  ADP is "Adenosine Diphosphate";
  AMP is "Adenosine Monophosphate";

end
