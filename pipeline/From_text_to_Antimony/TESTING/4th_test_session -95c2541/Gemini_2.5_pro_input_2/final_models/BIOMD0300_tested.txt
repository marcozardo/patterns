model *Schmierer2010_HIF_FIH_ARD()

    // Created by the Systems Biology Model Extractor and Encoder
    // Based on: Schmierer et al. BMC Systems Biology 2010, 4:139
    // Paper URL: http://www.biomedcentral.com/1752-0509/4/139
    // This model represents the "Full Model" described in the paper.
    // All variables and parameters are dimensionless as per the original publication.

    //// Compartments and Species:
    // This is a kinetic model of protein interactions, compartments are not explicitly modeled.
    // A default compartment of size 1 is assumed.
    // The dynamic quantities are treated as variables, not as species in a compartment.
    compartment default_compartment;

    //// Assignment Rules:
    // Mass conservation for hydroxylated forms
    Hhat_OH := Hhat_tot - Hhat;
    Ahat_OH := Ahat_tot - Ahat;

    // Apparent dissociation constant for FIH/HIF-alpha binding, accounting for ARD competition (Eq. 8)
    Khat_i_FH := Khat_D_FH * (1 + Ahat/Khat_D_FA + gamma_*Ahat_OH/Khat_D_FA);

    // Hydroxylation Rate Functions (dimensionless rates)
    // 1. PHD-dependent HIF-alpha ODD-hydroxylation rate (Eq. 4)
    nu_p_dot := k_cat_prime_p * Phat_tot * (1/(Khat_D_p + Hhat_tot + Phat_tot)) * (O2_tilde / (1 + O2_tilde));

    // 2. FIH-dependent HIF-alpha CAD-hydroxylation rate (Eq. 6)
    nu_FH_dot := k_cat_prime_FH * Fhat_tot * (1/(Khat_i_FH + Hhat + Fhat_tot)) * (O2_tilde / (alpha + O2_tilde));

    // 3. FIH-dependent AR-hydroxylation rate (Eq. 9)
    // NOTE: The oxygen-dependent term in the original paper (Eq. 9) is `1 / (O2_tilde / (alpha + O2_tilde))`,
    // which seems to be a typographical error as it would lead to an infinite rate at zero oxygen.
    // The term has been corrected to `(O2_tilde / (alpha + O2_tilde))` to reflect a standard oxygen-dependent enzymatic reaction.
    nu_FA_dot := k_cat_prime_FA * Fhat_tot / (Khat_D_FA * (1 + Hhat/Khat_D_FH) + Ahat + gamma_*Ahat_OH) * (O2_tilde / (alpha + O2_tilde));

    // Output variables: Fraction of Hypoxia Response Elements (HRE) occupied
    HRE_CAD := Hhat / (Khat_D_HRE + Hhat_tot);
    HRE_CADOH := Hhat_OH / (Khat_D_HRE + Hhat_tot);

    //// Rate Rules:
    // ODEs for the Full Model (Eqs. 1-3)
    // Eq. 1: Rate of change of total HIF-alpha
    Hhat_tot' = 1 - Hhat_tot * (1 + nu_p_dot);

    // Eq. 2: Rate of change of non-CAD-hydroxylated HIF-alpha
    Hhat' = 1 - Hhat * (1 + nu_p_dot + nu_FH_dot);

    // Eq. 3: Rate of change of unhydroxylated FIH target ankyrin repeats (ARs)
    Ahat' = (Ahat_tot - Ahat*(1 + epsilon*nu_FA_dot))/epsilon;

    //// Reactions:
    // The model is formulated using ODEs (Rate Rules) rather than explicit reactions.

    //// Events:
    // No events are described in the model.

    //// Species initializations:
    // Initial conditions for the state variables.
    // Hhat_tot and Hhat are initialized to 1, representing the maximal amount of HIF-alpha in the absence of oxygen.
    // Ahat is initialized to Ahat_tot, assuming all ARs are unhydroxylated initially.
    
    //// Compartment initializations:
    default_compartment = 1;

    //// Variable initializations:
    Hhat_tot = 1;
    Hhat = 1;
    Ahat = Ahat_tot;
    // Dimensionless parameter values from Table 2 and the text.
    // Default values are chosen based on the paper's figures, particularly Figure 5.
    Phat_tot = 0.2;      // PHD concentration
    Khat_D_p = 1;        // Dissociation constant of PHD/HIF-alpha binding
    k_cat_prime_p = 500; // (kcat for ODD-hydroxylation)/(basal HIF-alpha degradation rate)

    Fhat_tot = 1;        // FIH concentration
    Khat_D_FH = 1;       // Dissociation constant of FIH/HIF-alpha binding

    // k_cat_prime_FH is derived from k_cat_prime_p and parameter 'xi' (Table 2, #6), where xi = kcat_FH/kcat_P = 1.
    k_cat_prime_FH = 500; // (kcat for CAD-hydroxylation)/(basal HIF-alpha degradation rate)

    alpha = 0.33;        // (KM of FIH for oxygen)/(KM of PHD for oxygen)

    Ahat_tot = 100;      // Total concentration of FIH target ARs (varied parameter, default value selected)
    Khat_D_FA = 1;       // Dissociation constant of FIH/ARD binding (unhydroxylated ARs)

    // k_cat_prime_FA is derived from Table 2 (#6, image part showing xi=kcat_FH/kcat_FA) and xi=1.
    k_cat_prime_FA = 500;

    gamma_ = 0.02;        // (FIH affinity for hydroxylated ARs)/(FIH affinity for unhydroxylated ARs) (varied, default selected)
    epsilon = 5;         // (basal HIF-alpha degradation rate)/(AR degradation rate) (varied, default selected)

    Khat_D_HRE = 0.3;    // Dissociation constant of HIF/HRE binding

    O2_tilde = 0.1;      // Relative oxygen concentration (varied parameter)

    //// Other declarations:
    var Hhat_tot, Hhat, Ahat;
    var Hhat_OH, Ahat_OH, Khat_i_FH, nu_p_dot, nu_FH_dot, nu_FA_dot;
    var HRE_CAD, HRE_CADOH;
    const Phat_tot, Khat_D_p, k_cat_prime_p, Fhat_tot, Khat_D_FH, k_cat_prime_FH;
    const alpha, Ahat_tot, Khat_D_FA, k_cat_prime_FA, gamma_, epsilon, Khat_D_HRE, O2_tilde;
    const default_compartment;

    //// Display Names:
    // Based on Table 1 and model description
    Hhat_tot is "Total HIF-alpha (dimensionless)";
    Hhat is "Non-CAD-hydroxylated HIF-alpha (dimensionless)";
    Hhat_OH is "CAD-hydroxylated HIF-alpha (dimensionless)";
    Ahat is "Unhydroxylated FIH target ARs (dimensionless)";
    Ahat_OH is "Hydroxylated FIH target ARs (dimensionless)";
    Ahat_tot is "Total FIH target ARs (dimensionless)";
    Phat_tot is "Total PHD (dimensionless)";
    Fhat_tot is "Total FIH (dimensionless)";
    O2_tilde is "Relative intracellular oxygen concentration";

end
